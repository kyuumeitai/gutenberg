{"version":3,"sources":["/Users/ky/Sites/valet/copesacontent/web/app/plugins/gutenberg/packages/block-library/src/categories/edit.js"],"names":["CategoriesEdit","arguments","toggleDisplayAsDropdown","bind","toggleShowPostCounts","toggleShowHierarchy","props","attributes","setAttributes","displayAsDropdown","showPostCounts","showHierarchy","parentId","categories","length","filter","category","parent","level","className","name","trim","getCategories","getCategoryListClassName","map","renderCategoryListItem","childCategories","id","link","renderCategoryName","count","childCategory","instanceId","selectId","renderCategoryDropdownItem","isRequesting","align","inspectorControls","nextAlign","renderCategoryDropdown","renderCategoryList","Component","select","getEntityRecords","isResolving","query","per_page","withInstanceId"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { times, unescape } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { Component, Fragment } from '@wordpress/element';\nimport { PanelBody, Placeholder, Spinner, ToggleControl } from '@wordpress/components';\nimport { withSelect } from '@wordpress/data';\nimport { __ } from '@wordpress/i18n';\nimport { withInstanceId, compose } from '@wordpress/compose';\nimport {\n\tInspectorControls,\n\tBlockControls,\n\tBlockAlignmentToolbar,\n} from '@wordpress/editor';\n\nclass CategoriesEdit extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\n\t\tthis.toggleDisplayAsDropdown = this.toggleDisplayAsDropdown.bind( this );\n\t\tthis.toggleShowPostCounts = this.toggleShowPostCounts.bind( this );\n\t\tthis.toggleShowHierarchy = this.toggleShowHierarchy.bind( this );\n\t}\n\n\ttoggleDisplayAsDropdown() {\n\t\tconst { attributes, setAttributes } = this.props;\n\t\tconst { displayAsDropdown } = attributes;\n\n\t\tsetAttributes( { displayAsDropdown: ! displayAsDropdown } );\n\t}\n\n\ttoggleShowPostCounts() {\n\t\tconst { attributes, setAttributes } = this.props;\n\t\tconst { showPostCounts } = attributes;\n\n\t\tsetAttributes( { showPostCounts: ! showPostCounts } );\n\t}\n\n\ttoggleShowHierarchy() {\n\t\tconst { attributes, setAttributes } = this.props;\n\t\tconst { showHierarchy } = attributes;\n\n\t\tsetAttributes( { showHierarchy: ! showHierarchy } );\n\t}\n\n\tgetCategories( parentId = null ) {\n\t\tconst categories = this.props.categories;\n\t\tif ( ! categories || ! categories.length ) {\n\t\t\treturn [];\n\t\t}\n\n\t\tif ( parentId === null ) {\n\t\t\treturn categories;\n\t\t}\n\n\t\treturn categories.filter( ( category ) => category.parent === parentId );\n\t}\n\n\tgetCategoryListClassName( level ) {\n\t\tconst { className } = this.props;\n\t\treturn `${ className }__list ${ className }__list-level-${ level }`;\n\t}\n\n\trenderCategoryName( category ) {\n\t\tif ( ! category.name ) {\n\t\t\treturn __( '(Untitled)' );\n\t\t}\n\n\t\treturn unescape( category.name ).trim();\n\t}\n\n\trenderCategoryList() {\n\t\tconst { showHierarchy } = this.props.attributes;\n\t\tconst parentId = showHierarchy ? 0 : null;\n\t\tconst categories = this.getCategories( parentId );\n\n\t\treturn (\n\t\t\t<ul className={ this.getCategoryListClassName( 0 ) }>\n\t\t\t\t{ categories.map( ( category ) => this.renderCategoryListItem( category, 0 ) ) }\n\t\t\t</ul>\n\t\t);\n\t}\n\n\trenderCategoryListItem( category, level ) {\n\t\tconst { showHierarchy, showPostCounts } = this.props.attributes;\n\t\tconst childCategories = this.getCategories( category.id );\n\n\t\treturn (\n\t\t\t<li key={ category.id }>\n\t\t\t\t<a href={ category.link } target=\"_blank\">{ this.renderCategoryName( category ) }</a>\n\t\t\t\t{ showPostCounts &&\n\t\t\t\t\t<span className={ `${ this.props.className }__post-count` }>\n\t\t\t\t\t\t{ ' ' }({ category.count })\n\t\t\t\t\t</span>\n\t\t\t\t}\n\n\t\t\t\t{\n\t\t\t\t\tshowHierarchy &&\n\t\t\t\t\t!! childCategories.length && (\n\t\t\t\t\t\t<ul className={ this.getCategoryListClassName( level + 1 ) }>\n\t\t\t\t\t\t\t{ childCategories.map( ( childCategory ) => this.renderCategoryListItem( childCategory, level + 1 ) ) }\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t</li>\n\t\t);\n\t}\n\n\trenderCategoryDropdown() {\n\t\tconst { showHierarchy, instanceId, className } = this.props;\n\t\tconst parentId = showHierarchy ? 0 : null;\n\t\tconst categories = this.getCategories( parentId );\n\t\tconst selectId = `blocks-category-select-${ instanceId }`;\n\t\treturn (\n\t\t\t<Fragment>\n\t\t\t\t<label htmlFor={ selectId } className=\"screen-reader-text\">\n\t\t\t\t\t{ __( 'Categories' ) }\n\t\t\t\t</label>\n\t\t\t\t<select id={ selectId } className={ `${ className }__dropdown` }>\n\t\t\t\t\t{ categories.map( ( category ) => this.renderCategoryDropdownItem( category, 0 ) ) }\n\t\t\t\t</select>\n\t\t\t</Fragment>\n\t\t);\n\t}\n\n\trenderCategoryDropdownItem( category, level ) {\n\t\tconst { showHierarchy, showPostCounts } = this.props.attributes;\n\t\tconst childCategories = this.getCategories( category.id );\n\n\t\treturn [\n\t\t\t<option key={ category.id }>\n\t\t\t\t{ times( level * 3, () => '\\xa0' ) }\n\t\t\t\t{ this.renderCategoryName( category ) }\n\t\t\t\t{\n\t\t\t\t\t!! showPostCounts ?\n\t\t\t\t\t\t` (${ category.count })` :\n\t\t\t\t\t\t''\n\t\t\t\t}\n\t\t\t</option>,\n\t\t\tshowHierarchy &&\n\t\t\t!! childCategories.length && (\n\t\t\t\tchildCategories.map( ( childCategory ) => this.renderCategoryDropdownItem( childCategory, level + 1 ) )\n\t\t\t),\n\t\t];\n\t}\n\n\trender() {\n\t\tconst { attributes, setAttributes, isRequesting } = this.props;\n\t\tconst { align, displayAsDropdown, showHierarchy, showPostCounts } = attributes;\n\n\t\tconst inspectorControls = (\n\t\t\t<InspectorControls>\n\t\t\t\t<PanelBody title={ __( 'Categories Settings' ) }>\n\t\t\t\t\t<ToggleControl\n\t\t\t\t\t\tlabel={ __( 'Display as Dropdown' ) }\n\t\t\t\t\t\tchecked={ displayAsDropdown }\n\t\t\t\t\t\tonChange={ this.toggleDisplayAsDropdown }\n\t\t\t\t\t/>\n\t\t\t\t\t<ToggleControl\n\t\t\t\t\t\tlabel={ __( 'Show Hierarchy' ) }\n\t\t\t\t\t\tchecked={ showHierarchy }\n\t\t\t\t\t\tonChange={ this.toggleShowHierarchy }\n\t\t\t\t\t/>\n\t\t\t\t\t<ToggleControl\n\t\t\t\t\t\tlabel={ __( 'Show Post Counts' ) }\n\t\t\t\t\t\tchecked={ showPostCounts }\n\t\t\t\t\t\tonChange={ this.toggleShowPostCounts }\n\t\t\t\t\t/>\n\t\t\t\t</PanelBody>\n\t\t\t</InspectorControls>\n\t\t);\n\n\t\tif ( isRequesting ) {\n\t\t\treturn (\n\t\t\t\t<Fragment>\n\t\t\t\t\t{ inspectorControls }\n\t\t\t\t\t<Placeholder\n\t\t\t\t\t\ticon=\"admin-post\"\n\t\t\t\t\t\tlabel={ __( 'Categories' ) }\n\t\t\t\t\t>\n\t\t\t\t\t\t<Spinner />\n\t\t\t\t\t</Placeholder>\n\t\t\t\t</Fragment>\n\t\t\t);\n\t\t}\n\n\t\treturn (\n\t\t\t<Fragment>\n\t\t\t\t{ inspectorControls }\n\t\t\t\t<BlockControls>\n\t\t\t\t\t<BlockAlignmentToolbar\n\t\t\t\t\t\tvalue={ align }\n\t\t\t\t\t\tonChange={ ( nextAlign ) => {\n\t\t\t\t\t\t\tsetAttributes( { align: nextAlign } );\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tcontrols={ [ 'left', 'center', 'right', 'full' ] }\n\t\t\t\t\t/>\n\t\t\t\t</BlockControls>\n\t\t\t\t<div className={ this.props.className }>\n\t\t\t\t\t{\n\t\t\t\t\t\tdisplayAsDropdown ?\n\t\t\t\t\t\t\tthis.renderCategoryDropdown() :\n\t\t\t\t\t\t\tthis.renderCategoryList()\n\t\t\t\t\t}\n\t\t\t\t</div>\n\t\t\t</Fragment>\n\t\t);\n\t}\n}\nexport default compose(\n\twithSelect( ( select ) => {\n\t\tconst { getEntityRecords } = select( 'core' );\n\t\tconst { isResolving } = select( 'core/data' );\n\t\tconst query = { per_page: -1 };\n\n\t\treturn {\n\t\t\tcategories: getEntityRecords( 'taxonomy', 'category', query ),\n\t\t\tisRequesting: isResolving( 'core', 'getEntityRecords', [ 'taxonomy', 'category', query ] ),\n\t\t};\n\t} ),\n\twithInstanceId\n)( CategoriesEdit );\n"]}