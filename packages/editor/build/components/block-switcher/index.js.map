{"version":3,"sources":["/Users/ky/Sites/valet/copesacontent/web/app/plugins/gutenberg/packages/editor/src/components/block-switcher/index.js"],"names":["BlockSwitcher","arguments","state","hoveredClassName","onHoverClassName","bind","className","setState","props","blocks","onTransform","inserterItems","length","itemsByName","name","possibleBlockTransformations","block","frecency","sourceBlockName","blockType","hasStyles","onToggle","isOpen","openOnArrowDown","event","keyCode","DOWN","preventDefault","stopPropagation","label","icon","onClose","clientId","map","destinationBlockType","id","title","hasChildBlocksWithInserterSupport","item","attributes","Component","select","clientIds","getBlocksByClientId","getBlockRootClientId","getInserterItems","rootClientId","dispatch","ownProps","replaceBlocks"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { castArray, filter, first, get, mapKeys, orderBy } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { __, _n, sprintf } from '@wordpress/i18n';\nimport { Dropdown, IconButton, Toolbar, PanelBody, Path, SVG } from '@wordpress/components';\nimport { getBlockType, getPossibleBlockTransformations, switchToBlockType, hasChildBlocksWithInserterSupport } from '@wordpress/blocks';\nimport { Component, Fragment } from '@wordpress/element';\nimport { DOWN } from '@wordpress/keycodes';\nimport { withSelect, withDispatch } from '@wordpress/data';\nimport { compose } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport BlockIcon from '../block-icon';\nimport BlockStyles from '../block-styles';\nimport BlockPreview from '../block-preview';\nimport BlockTypesList from '../block-types-list';\n\nexport class BlockSwitcher extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\t\tthis.state = {\n\t\t\thoveredClassName: null,\n\t\t};\n\t\tthis.onHoverClassName = this.onHoverClassName.bind( this );\n\t}\n\n\tonHoverClassName( className ) {\n\t\tthis.setState( { hoveredClassName: className } );\n\t}\n\n\trender() {\n\t\tconst { blocks, onTransform, inserterItems } = this.props;\n\t\tconst { hoveredClassName } = this.state;\n\n\t\tif ( ! blocks || ! blocks.length ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst itemsByName = mapKeys( inserterItems, ( { name } ) => name );\n\t\tconst possibleBlockTransformations = orderBy(\n\t\t\tfilter(\n\t\t\t\tgetPossibleBlockTransformations( blocks ),\n\t\t\t\t( block ) => !! itemsByName[ block.name ]\n\t\t\t),\n\t\t\t( block ) => itemsByName[ block.name ].frecency,\n\t\t\t'desc'\n\t\t);\n\n\t\tconst sourceBlockName = blocks[ 0 ].name;\n\t\tconst blockType = getBlockType( sourceBlockName );\n\t\tconst hasStyles = blocks.length === 1 && get( blockType, [ 'styles' ], [] ).length !== 0;\n\n\t\tif ( ! hasStyles && ! possibleBlockTransformations.length ) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn (\n\t\t\t<Dropdown\n\t\t\t\tposition=\"bottom right\"\n\t\t\t\tclassName=\"editor-block-switcher\"\n\t\t\t\tcontentClassName=\"editor-block-switcher__popover\"\n\t\t\t\trenderToggle={ ( { onToggle, isOpen } ) => {\n\t\t\t\t\tconst openOnArrowDown = ( event ) => {\n\t\t\t\t\t\tif ( ! isOpen && event.keyCode === DOWN ) {\n\t\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\t\t\tonToggle();\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\tconst label = (\n\t\t\t\t\t\t1 === blocks.length ?\n\t\t\t\t\t\t\t__( 'Change block type' ) :\n\t\t\t\t\t\t\tsprintf(\n\t\t\t\t\t\t\t\t_n(\n\t\t\t\t\t\t\t\t\t'Change type of %d block',\n\t\t\t\t\t\t\t\t\t'Change type of %d blocks',\n\t\t\t\t\t\t\t\t\tblocks.length\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\tblocks.length\n\t\t\t\t\t\t\t)\n\t\t\t\t\t);\n\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<Toolbar>\n\t\t\t\t\t\t\t<IconButton\n\t\t\t\t\t\t\t\tclassName=\"editor-block-switcher__toggle\"\n\t\t\t\t\t\t\t\tonClick={ onToggle }\n\t\t\t\t\t\t\t\taria-haspopup=\"true\"\n\t\t\t\t\t\t\t\taria-expanded={ isOpen }\n\t\t\t\t\t\t\t\tlabel={ label }\n\t\t\t\t\t\t\t\ttooltip={ label }\n\t\t\t\t\t\t\t\tonKeyDown={ openOnArrowDown }\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<BlockIcon icon={ blockType.icon } showColors />\n\t\t\t\t\t\t\t\t<SVG className=\"editor-block-switcher__transform\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><Path d=\"M6.5 8.9c.6-.6 1.4-.9 2.2-.9h6.9l-1.3 1.3 1.4 1.4L19.4 7l-3.7-3.7-1.4 1.4L15.6 6H8.7c-1.4 0-2.6.5-3.6 1.5l-2.8 2.8 1.4 1.4 2.8-2.8zm13.8 2.4l-2.8 2.8c-.6.6-1.3.9-2.1.9h-7l1.3-1.3-1.4-1.4L4.6 16l3.7 3.7 1.4-1.4L8.4 17h6.9c1.3 0 2.6-.5 3.5-1.5l2.8-2.8-1.3-1.4z\" /></SVG>\n\t\t\t\t\t\t\t</IconButton>\n\t\t\t\t\t\t</Toolbar>\n\t\t\t\t\t);\n\t\t\t\t} }\n\t\t\t\trenderContent={ ( { onClose } ) => (\n\t\t\t\t\t<Fragment>\n\t\t\t\t\t\t{ hasStyles &&\n\t\t\t\t\t\t\t<PanelBody\n\t\t\t\t\t\t\t\ttitle={ __( 'Block Styles' ) }\n\t\t\t\t\t\t\t\tinitialOpen\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<BlockStyles\n\t\t\t\t\t\t\t\t\tclientId={ blocks[ 0 ].clientId }\n\t\t\t\t\t\t\t\t\tonSwitch={ onClose }\n\t\t\t\t\t\t\t\t\tonHoverClassName={ this.onHoverClassName }\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</PanelBody>\n\t\t\t\t\t\t}\n\t\t\t\t\t\t{ possibleBlockTransformations.length !== 0 &&\n\t\t\t\t\t\t\t<PanelBody\n\t\t\t\t\t\t\t\ttitle={ __( 'Transform To:' ) }\n\t\t\t\t\t\t\t\tinitialOpen\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<BlockTypesList\n\t\t\t\t\t\t\t\t\titems={ possibleBlockTransformations.map( ( destinationBlockType ) => ( {\n\t\t\t\t\t\t\t\t\t\tid: destinationBlockType.name,\n\t\t\t\t\t\t\t\t\t\ticon: destinationBlockType.icon,\n\t\t\t\t\t\t\t\t\t\ttitle: destinationBlockType.title,\n\t\t\t\t\t\t\t\t\t\thasChildBlocksWithInserterSupport: hasChildBlocksWithInserterSupport( destinationBlockType.name ),\n\t\t\t\t\t\t\t\t\t} ) ) }\n\t\t\t\t\t\t\t\t\tonSelect={ ( item ) => {\n\t\t\t\t\t\t\t\t\t\tonTransform( blocks, item.id );\n\t\t\t\t\t\t\t\t\t\tonClose();\n\t\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</PanelBody>\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t{ ( hoveredClassName !== null ) &&\n\t\t\t\t\t\t\t<BlockPreview\n\t\t\t\t\t\t\t\tname={ blocks[ 0 ].name }\n\t\t\t\t\t\t\t\tattributes={ { ...blocks[ 0 ].attributes, className: hoveredClassName } }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t}\n\t\t\t\t\t</Fragment>\n\t\t\t\t) }\n\t\t\t/>\n\t\t);\n\t}\n}\n\nexport default compose(\n\twithSelect( ( select, { clientIds } ) => {\n\t\tconst { getBlocksByClientId, getBlockRootClientId, getInserterItems } = select( 'core/editor' );\n\t\tconst rootClientId = getBlockRootClientId( first( castArray( clientIds ) ) );\n\t\treturn {\n\t\t\tblocks: getBlocksByClientId( clientIds ),\n\t\t\tinserterItems: getInserterItems( rootClientId ),\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch, ownProps ) => ( {\n\t\tonTransform( blocks, name ) {\n\t\t\tdispatch( 'core/editor' ).replaceBlocks(\n\t\t\t\townProps.clientIds,\n\t\t\t\tswitchToBlockType( blocks, name )\n\t\t\t);\n\t\t},\n\t} ) ),\n)( BlockSwitcher );\n"]}