{"version":3,"sources":["/Users/ky/Sites/valet/copesacontent/web/app/plugins/gutenberg/packages/block-library/src/gallery/edit.js"],"names":["MAX_COLUMNS","linkOptions","value","label","ALLOWED_MEDIA_TYPES","defaultColumnsNumber","attributes","Math","min","images","length","pickRelevantMediaFiles","image","GalleryEdit","arguments","onSelectImage","bind","onSelectImages","setLinkTo","setColumnsNumber","toggleImageCrop","onRemoveImage","setImageAttributes","addFiles","uploadFromFiles","state","selectedImage","index","setState","props","img","i","columns","setAttributes","map","linkTo","imageCrop","checked","slice","event","target","files","currentImages","noticeOperations","allowedTypes","filesList","onFileChange","imagesNormalized","concat","onError","createErrorNotice","prevProps","isSelected","captionSelected","className","noticeUI","align","dropZone","controls","id","open","title","instructions","getImageCropHelp","ariaLabel","url","alt","attrs","caption","Component"],"mappings":"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","sourcesContent":["/**\n * External Dependencies\n */\nimport { filter, pick } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { Component, Fragment } from '@wordpress/element';\nimport { __, sprintf } from '@wordpress/i18n';\nimport {\n\tIconButton,\n\tDropZone,\n\tFormFileUpload,\n\tPanelBody,\n\tRangeControl,\n\tSelectControl,\n\tToggleControl,\n\tToolbar,\n\twithNotices,\n} from '@wordpress/components';\nimport {\n\tBlockControls,\n\tMediaUpload,\n\tMediaPlaceholder,\n\tInspectorControls,\n\tmediaUpload,\n} from '@wordpress/editor';\n\n/**\n * Internal dependencies\n */\nimport GalleryImage from './gallery-image';\n\nconst MAX_COLUMNS = 8;\nconst linkOptions = [\n\t{ value: 'attachment', label: __( 'Attachment Page' ) },\n\t{ value: 'media', label: __( 'Media File' ) },\n\t{ value: 'none', label: __( 'None' ) },\n];\nconst ALLOWED_MEDIA_TYPES = [ 'image' ];\n\nexport function defaultColumnsNumber( attributes ) {\n\treturn Math.min( 3, attributes.images.length );\n}\n\nexport const pickRelevantMediaFiles = ( image ) => {\n\treturn pick( image, [ 'alt', 'id', 'link', 'url', 'caption' ] );\n};\n\nclass GalleryEdit extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\n\t\tthis.onSelectImage = this.onSelectImage.bind( this );\n\t\tthis.onSelectImages = this.onSelectImages.bind( this );\n\t\tthis.setLinkTo = this.setLinkTo.bind( this );\n\t\tthis.setColumnsNumber = this.setColumnsNumber.bind( this );\n\t\tthis.toggleImageCrop = this.toggleImageCrop.bind( this );\n\t\tthis.onRemoveImage = this.onRemoveImage.bind( this );\n\t\tthis.setImageAttributes = this.setImageAttributes.bind( this );\n\t\tthis.addFiles = this.addFiles.bind( this );\n\t\tthis.uploadFromFiles = this.uploadFromFiles.bind( this );\n\n\t\tthis.state = {\n\t\t\tselectedImage: null,\n\t\t};\n\t}\n\n\tonSelectImage( index ) {\n\t\treturn () => {\n\t\t\tif ( this.state.selectedImage !== index ) {\n\t\t\t\tthis.setState( {\n\t\t\t\t\tselectedImage: index,\n\t\t\t\t} );\n\t\t\t}\n\t\t};\n\t}\n\n\tonRemoveImage( index ) {\n\t\treturn () => {\n\t\t\tconst images = filter( this.props.attributes.images, ( img, i ) => index !== i );\n\t\t\tconst { columns } = this.props.attributes;\n\t\t\tthis.setState( { selectedImage: null } );\n\t\t\tthis.props.setAttributes( {\n\t\t\t\timages,\n\t\t\t\tcolumns: columns ? Math.min( images.length, columns ) : columns,\n\t\t\t} );\n\t\t};\n\t}\n\n\tonSelectImages( images ) {\n\t\tthis.props.setAttributes( {\n\t\t\timages: images.map( ( image ) => pickRelevantMediaFiles( image ) ),\n\t\t} );\n\t}\n\n\tsetLinkTo( value ) {\n\t\tthis.props.setAttributes( { linkTo: value } );\n\t}\n\n\tsetColumnsNumber( value ) {\n\t\tthis.props.setAttributes( { columns: value } );\n\t}\n\n\ttoggleImageCrop() {\n\t\tthis.props.setAttributes( { imageCrop: ! this.props.attributes.imageCrop } );\n\t}\n\n\tgetImageCropHelp( checked ) {\n\t\treturn checked ? __( 'Thumbnails are cropped to align.' ) : __( 'Thumbnails are not cropped.' );\n\t}\n\n\tsetImageAttributes( index, attributes ) {\n\t\tconst { attributes: { images }, setAttributes } = this.props;\n\t\tif ( ! images[ index ] ) {\n\t\t\treturn;\n\t\t}\n\t\tsetAttributes( {\n\t\t\timages: [\n\t\t\t\t...images.slice( 0, index ),\n\t\t\t\t{\n\t\t\t\t\t...images[ index ],\n\t\t\t\t\t...attributes,\n\t\t\t\t},\n\t\t\t\t...images.slice( index + 1 ),\n\t\t\t],\n\t\t} );\n\t}\n\n\tuploadFromFiles( event ) {\n\t\tthis.addFiles( event.target.files );\n\t}\n\n\taddFiles( files ) {\n\t\tconst currentImages = this.props.attributes.images || [];\n\t\tconst { noticeOperations, setAttributes } = this.props;\n\t\tmediaUpload( {\n\t\t\tallowedTypes: ALLOWED_MEDIA_TYPES,\n\t\t\tfilesList: files,\n\t\t\tonFileChange: ( images ) => {\n\t\t\t\tconst imagesNormalized = images.map( ( image ) => pickRelevantMediaFiles( image ) );\n\t\t\t\tsetAttributes( {\n\t\t\t\t\timages: currentImages.concat( imagesNormalized ),\n\t\t\t\t} );\n\t\t\t},\n\t\t\tonError: noticeOperations.createErrorNotice,\n\t\t} );\n\t}\n\n\tcomponentDidUpdate( prevProps ) {\n\t\t// Deselect images when deselecting the block\n\t\tif ( ! this.props.isSelected && prevProps.isSelected ) {\n\t\t\tthis.setState( {\n\t\t\t\tselectedImage: null,\n\t\t\t\tcaptionSelected: false,\n\t\t\t} );\n\t\t}\n\t}\n\n\trender() {\n\t\tconst { attributes, isSelected, className, noticeOperations, noticeUI } = this.props;\n\t\tconst { images, columns = defaultColumnsNumber( attributes ), align, imageCrop, linkTo } = attributes;\n\n\t\tconst dropZone = (\n\t\t\t<DropZone\n\t\t\t\tonFilesDrop={ this.addFiles }\n\t\t\t/>\n\t\t);\n\n\t\tconst controls = (\n\t\t\t<BlockControls>\n\t\t\t\t{ !! images.length && (\n\t\t\t\t\t<Toolbar>\n\t\t\t\t\t\t<MediaUpload\n\t\t\t\t\t\t\tonSelect={ this.onSelectImages }\n\t\t\t\t\t\t\tallowedTypes={ ALLOWED_MEDIA_TYPES }\n\t\t\t\t\t\t\tmultiple\n\t\t\t\t\t\t\tgallery\n\t\t\t\t\t\t\tvalue={ images.map( ( img ) => img.id ) }\n\t\t\t\t\t\t\trender={ ( { open } ) => (\n\t\t\t\t\t\t\t\t<IconButton\n\t\t\t\t\t\t\t\t\tclassName=\"components-toolbar__control\"\n\t\t\t\t\t\t\t\t\tlabel={ __( 'Edit Gallery' ) }\n\t\t\t\t\t\t\t\t\ticon=\"edit\"\n\t\t\t\t\t\t\t\t\tonClick={ open }\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Toolbar>\n\t\t\t\t) }\n\t\t\t</BlockControls>\n\t\t);\n\n\t\tif ( images.length === 0 ) {\n\t\t\treturn (\n\t\t\t\t<Fragment>\n\t\t\t\t\t{ controls }\n\t\t\t\t\t<MediaPlaceholder\n\t\t\t\t\t\ticon=\"format-gallery\"\n\t\t\t\t\t\tclassName={ className }\n\t\t\t\t\t\tlabels={ {\n\t\t\t\t\t\t\ttitle: __( 'Gallery' ),\n\t\t\t\t\t\t\tinstructions: __( 'Drag images, upload new ones or select files from your library.' ),\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tonSelect={ this.onSelectImages }\n\t\t\t\t\t\taccept=\"image/*\"\n\t\t\t\t\t\tallowedTypes={ ALLOWED_MEDIA_TYPES }\n\t\t\t\t\t\tmultiple\n\t\t\t\t\t\tnotices={ noticeUI }\n\t\t\t\t\t\tonError={ noticeOperations.createErrorNotice }\n\t\t\t\t\t/>\n\t\t\t\t</Fragment>\n\t\t\t);\n\t\t}\n\n\t\treturn (\n\t\t\t<Fragment>\n\t\t\t\t{ controls }\n\t\t\t\t<InspectorControls>\n\t\t\t\t\t<PanelBody title={ __( 'Gallery Settings' ) }>\n\t\t\t\t\t\t{ images.length > 1 && <RangeControl\n\t\t\t\t\t\t\tlabel={ __( 'Columns' ) }\n\t\t\t\t\t\t\tvalue={ columns }\n\t\t\t\t\t\t\tonChange={ this.setColumnsNumber }\n\t\t\t\t\t\t\tmin={ 1 }\n\t\t\t\t\t\t\tmax={ Math.min( MAX_COLUMNS, images.length ) }\n\t\t\t\t\t\t/> }\n\t\t\t\t\t\t<ToggleControl\n\t\t\t\t\t\t\tlabel={ __( 'Crop Images' ) }\n\t\t\t\t\t\t\tchecked={ !! imageCrop }\n\t\t\t\t\t\t\tonChange={ this.toggleImageCrop }\n\t\t\t\t\t\t\thelp={ this.getImageCropHelp }\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<SelectControl\n\t\t\t\t\t\t\tlabel={ __( 'Link To' ) }\n\t\t\t\t\t\t\tvalue={ linkTo }\n\t\t\t\t\t\t\tonChange={ this.setLinkTo }\n\t\t\t\t\t\t\toptions={ linkOptions }\n\t\t\t\t\t\t/>\n\t\t\t\t\t</PanelBody>\n\t\t\t\t</InspectorControls>\n\t\t\t\t{ noticeUI }\n\t\t\t\t<ul className={ `${ className } align${ align } columns-${ columns } ${ imageCrop ? 'is-cropped' : '' }` }>\n\t\t\t\t\t{ dropZone }\n\t\t\t\t\t{ images.map( ( img, index ) => {\n\t\t\t\t\t\t/* translators: %1$d is the order number of the image, %2$d is the total number of images. */\n\t\t\t\t\t\tconst ariaLabel = __( sprintf( 'image %1$d of %2$d in gallery', ( index + 1 ), images.length ) );\n\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<li className=\"blocks-gallery-item\" key={ img.id || img.url }>\n\t\t\t\t\t\t\t\t<GalleryImage\n\t\t\t\t\t\t\t\t\turl={ img.url }\n\t\t\t\t\t\t\t\t\talt={ img.alt }\n\t\t\t\t\t\t\t\t\tid={ img.id }\n\t\t\t\t\t\t\t\t\tisSelected={ isSelected && this.state.selectedImage === index }\n\t\t\t\t\t\t\t\t\tonRemove={ this.onRemoveImage( index ) }\n\t\t\t\t\t\t\t\t\tonSelect={ this.onSelectImage( index ) }\n\t\t\t\t\t\t\t\t\tsetAttributes={ ( attrs ) => this.setImageAttributes( index, attrs ) }\n\t\t\t\t\t\t\t\t\tcaption={ img.caption }\n\t\t\t\t\t\t\t\t\taria-label={ ariaLabel }\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t);\n\t\t\t\t\t} ) }\n\t\t\t\t\t{ isSelected &&\n\t\t\t\t\t\t<li className=\"blocks-gallery-item has-add-item-button\">\n\t\t\t\t\t\t\t<FormFileUpload\n\t\t\t\t\t\t\t\tmultiple\n\t\t\t\t\t\t\t\tisLarge\n\t\t\t\t\t\t\t\tclassName=\"block-library-gallery-add-item-button\"\n\t\t\t\t\t\t\t\tonChange={ this.uploadFromFiles }\n\t\t\t\t\t\t\t\taccept=\"image/*\"\n\t\t\t\t\t\t\t\ticon=\"insert\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{ __( 'Upload an image' ) }\n\t\t\t\t\t\t\t</FormFileUpload>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t}\n\t\t\t\t</ul>\n\t\t\t</Fragment>\n\t\t);\n\t}\n}\n\nexport default withNotices( GalleryEdit );\n"]}