{"version":3,"sources":["/Users/ky/Sites/valet/copesacontent/web/app/plugins/gutenberg/packages/data/src/components/with-dispatch/index.js"],"names":["mapValues","Component","pure","compose","createHigherOrderComponent","RegistryConsumer","withDispatch","mapDispatchToProps","WrappedComponent","ComponentWithDispatch","props","arguments","proxyProps","setProxyProps","propName","args","registry","dispatch","ownProps","propsToDispatchers","dispatcher","hasOwnProperty","proxyDispatch","bind"],"mappings":";;;;;;;;AAAA;;;AAGA,SAASA,SAAT,QAA0B,QAA1B;AAEA;;;;AAGA,SAASC,SAAT,QAA0B,oBAA1B;AACA,SAASC,IAAT,EAAeC,OAAf,EAAwBC,0BAAxB,QAA0D,oBAA1D;AAEA;;;;AAGA,SAASC,gBAAT,QAAiC,sBAAjC;AAEA;;;;;;;;;;;;;AAYA,IAAMC,YAAY,GAAG,SAAfA,YAAe,CAAEC,kBAAF;AAAA,SAA0BH,0BAA0B,CACxED,OAAO,CAAE,CACRD,IADQ,EAER,UAAEM,gBAAF,EAAwB;AAAA,QACjBC,qBADiB;AAAA;AAAA;AAAA;;AAEtB,qCAAaC,KAAb,EAAqB;AAAA;;AAAA;;AACpB,oGAAUC,SAAV;AAEA,cAAKC,UAAL,GAAkB,EAAlB;;AACA,cAAKC,aAAL,CAAoBH,KAApB;;AAJoB;AAKpB;;AAPqB;AAAA;AAAA,6CASD;AACpB,eAAKG,aAAL,CAAoB,KAAKH,KAAzB;AACA;AAXqB;AAAA;AAAA,sCAaPI,QAbO,EAaa;AAAA;;AAAA,4CAAPC,IAAO;AAAPA,YAAAA,IAAO;AAAA;;AAClC;AACA,iCAAAR,kBAAkB,CAAE,KAAKG,KAAL,CAAWM,QAAX,CAAoBC,QAAtB,EAAgC,KAAKP,KAAL,CAAWQ,QAA3C,CAAlB,EAAyEJ,QAAzE,6BAAwFC,IAAxF;AACA;AAhBqB;AAAA;AAAA,sCAkBPL,KAlBO,EAkBC;AAAA;;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,cAAMS,kBAAkB,GAAGZ,kBAAkB,CAAE,KAAKG,KAAL,CAAWM,QAAX,CAAoBC,QAAtB,EAAgCP,KAAK,CAACQ,QAAtC,CAA7C;AACA,eAAKN,UAAL,GAAkBZ,SAAS,CAAEmB,kBAAF,EAAsB,UAAEC,UAAF,EAAcN,QAAd,EAA4B;AAC5E;AACA;AACA;AACA,gBAAK,MAAI,CAACF,UAAL,CAAgBS,cAAhB,CAAgCP,QAAhC,CAAL,EAAkD;AACjD,qBAAO,MAAI,CAACF,UAAL,CAAiBE,QAAjB,CAAP;AACA;;AAED,mBAAO,MAAI,CAACQ,aAAL,CAAmBC,IAAnB,CAAyB,MAAzB,EAA+BT,QAA/B,CAAP;AACA,WAT0B,CAA3B;AAUA;AApCqB;AAAA;AAAA,iCAsCb;AACR,iBAAO,cAAC,gBAAD,eAAuB,KAAKJ,KAAL,CAAWQ,QAAlC,EAAkD,KAAKN,UAAvD,EAAP;AACA;AAxCqB;;AAAA;AAAA,MACaX,SADb;;AA2CvB,WAAO,UAAEiB,QAAF;AAAA,aACN,cAAC,gBAAD,QACG,UAAEF,QAAF;AAAA,eACD,cAAC,qBAAD;AACC,UAAA,QAAQ,EAAGE,QADZ;AAEC,UAAA,QAAQ,EAAGF;AAFZ,UADC;AAAA,OADH,CADM;AAAA,KAAP;AAUA,GAvDO,CAAF,CADiE,EA0DxE,cA1DwE,CAApD;AAAA,CAArB;;AA6DA,eAAeV,YAAf","sourcesContent":["/**\n * External dependencies\n */\nimport { mapValues } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { Component } from '@wordpress/element';\nimport { pure, compose, createHigherOrderComponent } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport { RegistryConsumer } from '../registry-provider';\n\n/**\n * Higher-order component used to add dispatch props using registered action\n * creators.\n *\n * @param {Object} mapDispatchToProps Object of prop names where value is a\n *                                    dispatch-bound action creator, or a\n *                                    function to be called with with the\n *                                    component's props and returning an\n *                                    action creator.\n *\n * @return {Component} Enhanced component with merged dispatcher props.\n */\nconst withDispatch = ( mapDispatchToProps ) => createHigherOrderComponent(\n\tcompose( [\n\t\tpure,\n\t\t( WrappedComponent ) => {\n\t\t\tclass ComponentWithDispatch extends Component {\n\t\t\t\tconstructor( props ) {\n\t\t\t\t\tsuper( ...arguments );\n\n\t\t\t\t\tthis.proxyProps = {};\n\t\t\t\t\tthis.setProxyProps( props );\n\t\t\t\t}\n\n\t\t\t\tcomponentDidUpdate() {\n\t\t\t\t\tthis.setProxyProps( this.props );\n\t\t\t\t}\n\n\t\t\t\tproxyDispatch( propName, ...args ) {\n\t\t\t\t\t// Original dispatcher is a pre-bound (dispatching) action creator.\n\t\t\t\t\tmapDispatchToProps( this.props.registry.dispatch, this.props.ownProps )[ propName ]( ...args );\n\t\t\t\t}\n\n\t\t\t\tsetProxyProps( props ) {\n\t\t\t\t\t// Assign as instance property so that in subsequent render\n\t\t\t\t\t// reconciliation, the prop values are referentially equal.\n\t\t\t\t\t// Importantly, note that while `mapDispatchToProps` is\n\t\t\t\t\t// called, it is done only to determine the keys for which\n\t\t\t\t\t// proxy functions should be created. The actual registry\n\t\t\t\t\t// dispatch does not occur until the function is called.\n\t\t\t\t\tconst propsToDispatchers = mapDispatchToProps( this.props.registry.dispatch, props.ownProps );\n\t\t\t\t\tthis.proxyProps = mapValues( propsToDispatchers, ( dispatcher, propName ) => {\n\t\t\t\t\t\t// Prebind with prop name so we have reference to the original\n\t\t\t\t\t\t// dispatcher to invoke. Track between re-renders to avoid\n\t\t\t\t\t\t// creating new function references every render.\n\t\t\t\t\t\tif ( this.proxyProps.hasOwnProperty( propName ) ) {\n\t\t\t\t\t\t\treturn this.proxyProps[ propName ];\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn this.proxyDispatch.bind( this, propName );\n\t\t\t\t\t} );\n\t\t\t\t}\n\n\t\t\t\trender() {\n\t\t\t\t\treturn <WrappedComponent { ...this.props.ownProps } { ...this.proxyProps } />;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn ( ownProps ) => (\n\t\t\t\t<RegistryConsumer>\n\t\t\t\t\t{ ( registry ) => (\n\t\t\t\t\t\t<ComponentWithDispatch\n\t\t\t\t\t\t\townProps={ ownProps }\n\t\t\t\t\t\t\tregistry={ registry }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t</RegistryConsumer>\n\t\t\t);\n\t\t},\n\t] ),\n\t'withDispatch'\n);\n\nexport default withDispatch;\n"]}