{"version":3,"sources":["/Users/ky/Sites/valet/copesacontent/web/app/plugins/gutenberg/packages/editor/src/components/post-featured-image/index.js"],"names":["has","get","__","applyFilters","Button","Spinner","ResponsiveWrapper","withFilters","compose","withSelect","withDispatch","PostFeaturedImageCheck","MediaUpload","ALLOWED_MEDIA_TYPES","DEFAULT_FEATURE_IMAGE_LABEL","DEFAULT_SET_FEATURE_IMAGE_LABEL","DEFAULT_REMOVE_FEATURE_IMAGE_LABEL","PostFeaturedImage","currentPostId","featuredImageId","onUpdateImage","onRemoveImage","media","postType","postLabel","mediaWidth","mediaHeight","mediaSourceUrl","mediaSize","id","media_details","sizes","width","height","source_url","featured_image","open","isLoading","set_featured_image","remove_featured_image","applyWithSelect","select","getMedia","getPostType","getCurrentPostId","getEditedPostAttribute","applyWithDispatch","dispatch","editPost","image","featured_media"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { has, get } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport { applyFilters } from '@wordpress/hooks';\nimport { Button, Spinner, ResponsiveWrapper, withFilters } from '@wordpress/components';\nimport { compose } from '@wordpress/compose';\nimport { withSelect, withDispatch } from '@wordpress/data';\n\n/**\n * Internal dependencies\n */\nimport PostFeaturedImageCheck from './check';\nimport MediaUpload from '../media-upload';\n\nconst ALLOWED_MEDIA_TYPES = [ 'image' ];\n\n// Used when labels from post type were not yet loaded or when they are not present.\nconst DEFAULT_FEATURE_IMAGE_LABEL = __( 'Featured Image' );\nconst DEFAULT_SET_FEATURE_IMAGE_LABEL = __( 'Set featured image' );\nconst DEFAULT_REMOVE_FEATURE_IMAGE_LABEL = __( 'Remove image' );\n\nfunction PostFeaturedImage( { currentPostId, featuredImageId, onUpdateImage, onRemoveImage, media, postType } ) {\n\tconst postLabel = get( postType, [ 'labels' ], {} );\n\n\tlet mediaWidth, mediaHeight, mediaSourceUrl;\n\tif ( media ) {\n\t\tconst mediaSize = applyFilters( 'editor.PostFeaturedImage.imageSize', 'post-thumbnail', media.id, currentPostId );\n\t\tif ( has( media, [ 'media_details', 'sizes', mediaSize ] ) ) {\n\t\t\tmediaWidth = media.media_details.sizes[ mediaSize ].width;\n\t\t\tmediaHeight = media.media_details.sizes[ mediaSize ].height;\n\t\t\tmediaSourceUrl = media.media_details.sizes[ mediaSize ].source_url;\n\t\t} else {\n\t\t\tmediaWidth = media.media_details.width;\n\t\t\tmediaHeight = media.media_details.height;\n\t\t\tmediaSourceUrl = media.source_url;\n\t\t}\n\t}\n\n\treturn (\n\t\t<PostFeaturedImageCheck>\n\t\t\t<div className=\"editor-post-featured-image\">\n\t\t\t\t{ !! featuredImageId &&\n\t\t\t\t\t<MediaUpload\n\t\t\t\t\t\ttitle={ postLabel.featured_image || DEFAULT_FEATURE_IMAGE_LABEL }\n\t\t\t\t\t\tonSelect={ onUpdateImage }\n\t\t\t\t\t\tallowedTypes={ ALLOWED_MEDIA_TYPES }\n\t\t\t\t\t\tmodalClass=\"editor-post-featured-image__media-modal\"\n\t\t\t\t\t\trender={ ( { open } ) => (\n\t\t\t\t\t\t\t<Button className=\"editor-post-featured-image__preview\" onClick={ open } aria-label={ __( 'Edit or update the image' ) }>\n\t\t\t\t\t\t\t\t{ media &&\n\t\t\t\t\t\t\t\t\t<ResponsiveWrapper\n\t\t\t\t\t\t\t\t\t\tnaturalWidth={ mediaWidth }\n\t\t\t\t\t\t\t\t\t\tnaturalHeight={ mediaHeight }\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<img src={ mediaSourceUrl } alt=\"\" />\n\t\t\t\t\t\t\t\t\t</ResponsiveWrapper>\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t{ ! media && <Spinner /> }\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t) }\n\t\t\t\t\t\tvalue={ featuredImageId }\n\t\t\t\t\t/>\n\t\t\t\t}\n\t\t\t\t{ !! featuredImageId && media && ! media.isLoading &&\n\t\t\t\t<MediaUpload\n\t\t\t\t\ttitle={ postLabel.featured_image || DEFAULT_FEATURE_IMAGE_LABEL }\n\t\t\t\t\tonSelect={ onUpdateImage }\n\t\t\t\t\tallowedTypes={ ALLOWED_MEDIA_TYPES }\n\t\t\t\t\tmodalClass=\"editor-post-featured-image__media-modal\"\n\t\t\t\t\trender={ ( { open } ) => (\n\t\t\t\t\t\t<Button onClick={ open } isDefault isLarge>\n\t\t\t\t\t\t\t{ __( 'Replace image' ) }\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t) }\n\t\t\t\t/>\n\t\t\t\t}\n\t\t\t\t{ ! featuredImageId &&\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<MediaUpload\n\t\t\t\t\t\t\ttitle={ postLabel.featured_image || DEFAULT_FEATURE_IMAGE_LABEL }\n\t\t\t\t\t\t\tonSelect={ onUpdateImage }\n\t\t\t\t\t\t\tallowedTypes={ ALLOWED_MEDIA_TYPES }\n\t\t\t\t\t\t\tmodalClass=\"editor-post-featured-image__media-modal\"\n\t\t\t\t\t\t\trender={ ( { open } ) => (\n\t\t\t\t\t\t\t\t<Button className=\"editor-post-featured-image__toggle\" onClick={ open }>\n\t\t\t\t\t\t\t\t\t{ postLabel.set_featured_image || DEFAULT_SET_FEATURE_IMAGE_LABEL }\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t}\n\t\t\t\t{ !! featuredImageId &&\n\t\t\t\t\t<Button onClick={ onRemoveImage } isLink isDestructive>\n\t\t\t\t\t\t{ postLabel.remove_featured_image || DEFAULT_REMOVE_FEATURE_IMAGE_LABEL }\n\t\t\t\t\t</Button>\n\t\t\t\t}\n\t\t\t</div>\n\t\t</PostFeaturedImageCheck>\n\t);\n}\n\nconst applyWithSelect = withSelect( ( select ) => {\n\tconst { getMedia, getPostType } = select( 'core' );\n\tconst { getCurrentPostId, getEditedPostAttribute } = select( 'core/editor' );\n\tconst featuredImageId = getEditedPostAttribute( 'featured_media' );\n\n\treturn {\n\t\tmedia: featuredImageId ? getMedia( featuredImageId ) : null,\n\t\tcurrentPostId: getCurrentPostId(),\n\t\tpostType: getPostType( getEditedPostAttribute( 'type' ) ),\n\t\tfeaturedImageId,\n\t};\n} );\n\nconst applyWithDispatch = withDispatch( ( dispatch ) => {\n\tconst { editPost } = dispatch( 'core/editor' );\n\treturn {\n\t\tonUpdateImage( image ) {\n\t\t\teditPost( { featured_media: image.id } );\n\t\t},\n\t\tonRemoveImage() {\n\t\t\teditPost( { featured_media: 0 } );\n\t\t},\n\t};\n} );\n\nexport default compose(\n\tapplyWithSelect,\n\tapplyWithDispatch,\n\twithFilters( 'editor.PostFeaturedImage' ),\n)( PostFeaturedImage );\n"]}