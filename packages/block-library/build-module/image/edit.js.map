{"version":3,"sources":["/Users/ky/Sites/valet/copesacontent/web/app/plugins/gutenberg/packages/block-library/src/image/edit.js"],"names":["classnames","get","isEmpty","map","pick","startCase","keyBy","__","Component","Fragment","getBlobByURL","revokeBlobURL","isBlobURL","Button","ButtonGroup","IconButton","PanelBody","ResizableBox","SelectControl","TextControl","TextareaControl","Toolbar","withNotices","ToggleControl","withSelect","RichText","BlockControls","InspectorControls","MediaPlaceholder","MediaUpload","BlockAlignmentToolbar","mediaUpload","withViewportMatch","compose","ImageSize","MIN_SIZE","LINK_DESTINATION_NONE","LINK_DESTINATION_MEDIA","LINK_DESTINATION_ATTACHMENT","LINK_DESTINATION_CUSTOM","ALLOWED_MEDIA_TYPES","pickRelevantMediaFiles","image","isTemporaryImage","id","url","isExternalImage","ImageEdit","attributes","arguments","updateAlt","bind","updateAlignment","onFocusCaption","onImageClick","onSelectImage","onSelectURL","updateImageURL","updateWidth","updateHeight","updateDimensions","onSetCustomHref","onSetLinkDestination","toggleIsEditing","state","captionFocused","isEditing","props","setAttributes","file","filesList","onFileChange","allowedTypes","prevProps","prevID","prevURL","isSelected","setState","media","undefined","alt","caption","width","height","value","href","source_url","link","linkDestination","newURL","newAlt","nextAlign","extraUpdatedAttributes","indexOf","align","parseInt","label","isLargeViewport","className","maxWidth","noticeOperations","noticeUI","toggleSelection","isRTL","availableImageSizes","linkTarget","isExternal","availableImageSizesBySlug","toolbarEditButton","open","controls","src","createErrorNotice","classes","imageSizes","getImageSizes","isResizable","isLinkURLInputDisabled","getInspectorControls","imageWidth","imageHeight","size","slug","name","scale","scaledWidth","Math","round","scaledHeight","isCurrent","getLinkDestinationOptions","sizes","imageWidthWithinContainer","imageHeightWithinContainer","img","currentWidth","currentHeight","ratio","minWidth","minHeight","showRightHandle","showLeftHandle","top","right","bottom","left","event","direction","elt","delta","select","getMedia","getEditorSettings"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\nimport {\n\tget,\n\tisEmpty,\n\tmap,\n\tpick,\n\tstartCase,\n\tkeyBy,\n} from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport { Component, Fragment } from '@wordpress/element';\nimport { getBlobByURL, revokeBlobURL, isBlobURL } from '@wordpress/blob';\nimport {\n\tButton,\n\tButtonGroup,\n\tIconButton,\n\tPanelBody,\n\tResizableBox,\n\tSelectControl,\n\tTextControl,\n\tTextareaControl,\n\tToolbar,\n\twithNotices,\n\tToggleControl,\n} from '@wordpress/components';\nimport { withSelect } from '@wordpress/data';\nimport {\n\tRichText,\n\tBlockControls,\n\tInspectorControls,\n\tMediaPlaceholder,\n\tMediaUpload,\n\tBlockAlignmentToolbar,\n\tmediaUpload,\n} from '@wordpress/editor';\nimport { withViewportMatch } from '@wordpress/viewport';\nimport { compose } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport ImageSize from './image-size';\n\n/**\n * Module constants\n */\nconst MIN_SIZE = 20;\nconst LINK_DESTINATION_NONE = 'none';\nconst LINK_DESTINATION_MEDIA = 'media';\nconst LINK_DESTINATION_ATTACHMENT = 'attachment';\nconst LINK_DESTINATION_CUSTOM = 'custom';\nconst ALLOWED_MEDIA_TYPES = [ 'image' ];\n\nexport const pickRelevantMediaFiles = ( image ) => {\n\treturn pick( image, [ 'alt', 'id', 'link', 'url', 'caption' ] );\n};\n\n/**\n * Is the URL a temporary blob URL? A blob URL is one that is used temporarily\n * while the image is being uploaded and will not have an id yet allocated.\n *\n * @param {number=} id The id of the image.\n * @param {string=} url The url of the image.\n *\n * @return {boolean} Is the URL a Blob URL\n */\nconst isTemporaryImage = ( id, url ) => ! id && isBlobURL( url );\n\n/**\n * Is the url for the image hosted externally. An externally hosted image has no id\n * and is not a blob url.\n *\n * @param {number=} id  The id of the image.\n * @param {string=} url The url of the image.\n *\n * @return {boolean} Is the url an externally hosted url?\n */\nconst isExternalImage = ( id, url ) => url && ! id && ! isBlobURL( url );\n\nclass ImageEdit extends Component {\n\tconstructor( { attributes } ) {\n\t\tsuper( ...arguments );\n\t\tthis.updateAlt = this.updateAlt.bind( this );\n\t\tthis.updateAlignment = this.updateAlignment.bind( this );\n\t\tthis.onFocusCaption = this.onFocusCaption.bind( this );\n\t\tthis.onImageClick = this.onImageClick.bind( this );\n\t\tthis.onSelectImage = this.onSelectImage.bind( this );\n\t\tthis.onSelectURL = this.onSelectURL.bind( this );\n\t\tthis.updateImageURL = this.updateImageURL.bind( this );\n\t\tthis.updateWidth = this.updateWidth.bind( this );\n\t\tthis.updateHeight = this.updateHeight.bind( this );\n\t\tthis.updateDimensions = this.updateDimensions.bind( this );\n\t\tthis.onSetCustomHref = this.onSetCustomHref.bind( this );\n\t\tthis.onSetLinkDestination = this.onSetLinkDestination.bind( this );\n\t\tthis.toggleIsEditing = this.toggleIsEditing.bind( this );\n\n\t\tthis.state = {\n\t\t\tcaptionFocused: false,\n\t\t\tisEditing: ! attributes.url,\n\t\t};\n\t}\n\n\tcomponentDidMount() {\n\t\tconst { attributes, setAttributes } = this.props;\n\t\tconst { id, url = '' } = attributes;\n\n\t\tif ( isTemporaryImage( id, url ) ) {\n\t\t\tconst file = getBlobByURL( url );\n\n\t\t\tif ( file ) {\n\t\t\t\tmediaUpload( {\n\t\t\t\t\tfilesList: [ file ],\n\t\t\t\t\tonFileChange: ( [ image ] ) => {\n\t\t\t\t\t\tsetAttributes( pickRelevantMediaFiles( image ) );\n\t\t\t\t\t},\n\t\t\t\t\tallowedTypes: ALLOWED_MEDIA_TYPES,\n\t\t\t\t} );\n\t\t\t}\n\t\t}\n\t}\n\n\tcomponentDidUpdate( prevProps ) {\n\t\tconst { id: prevID, url: prevURL = '' } = prevProps.attributes;\n\t\tconst { id, url = '' } = this.props.attributes;\n\n\t\tif ( isTemporaryImage( prevID, prevURL ) && ! isTemporaryImage( id, url ) ) {\n\t\t\trevokeBlobURL( url );\n\t\t}\n\n\t\tif ( ! this.props.isSelected && prevProps.isSelected && this.state.captionFocused ) {\n\t\t\tthis.setState( {\n\t\t\t\tcaptionFocused: false,\n\t\t\t} );\n\t\t}\n\t}\n\n\tonSelectImage( media ) {\n\t\tif ( ! media || ! media.url ) {\n\t\t\tthis.props.setAttributes( {\n\t\t\t\turl: undefined,\n\t\t\t\talt: undefined,\n\t\t\t\tid: undefined,\n\t\t\t\tcaption: undefined,\n\t\t\t} );\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setState( {\n\t\t\tisEditing: false,\n\t\t} );\n\n\t\tthis.props.setAttributes( {\n\t\t\t...pickRelevantMediaFiles( media ),\n\t\t\twidth: undefined,\n\t\t\theight: undefined,\n\t\t} );\n\t}\n\n\tonSetLinkDestination( value ) {\n\t\tlet href;\n\n\t\tif ( value === LINK_DESTINATION_NONE ) {\n\t\t\thref = undefined;\n\t\t} else if ( value === LINK_DESTINATION_MEDIA ) {\n\t\t\thref = ( this.props.image && this.props.image.source_url ) || this.props.attributes.url;\n\t\t} else if ( value === LINK_DESTINATION_ATTACHMENT ) {\n\t\t\thref = this.props.image && this.props.image.link;\n\t\t} else {\n\t\t\thref = this.props.attributes.href;\n\t\t}\n\n\t\tthis.props.setAttributes( {\n\t\t\tlinkDestination: value,\n\t\t\thref,\n\t\t} );\n\t}\n\n\tonSelectURL( newURL ) {\n\t\tconst { url } = this.props.attributes;\n\n\t\tif ( newURL !== url ) {\n\t\t\tthis.props.setAttributes( {\n\t\t\t\turl: newURL,\n\t\t\t\tid: undefined,\n\t\t\t} );\n\t\t}\n\n\t\tthis.setState( {\n\t\t\tisEditing: false,\n\t\t} );\n\t}\n\n\tonSetCustomHref( value ) {\n\t\tthis.props.setAttributes( { href: value } );\n\t}\n\n\tonFocusCaption() {\n\t\tif ( ! this.state.captionFocused ) {\n\t\t\tthis.setState( {\n\t\t\t\tcaptionFocused: true,\n\t\t\t} );\n\t\t}\n\t}\n\n\tonImageClick() {\n\t\tif ( this.state.captionFocused ) {\n\t\t\tthis.setState( {\n\t\t\t\tcaptionFocused: false,\n\t\t\t} );\n\t\t}\n\t}\n\n\tupdateAlt( newAlt ) {\n\t\tthis.props.setAttributes( { alt: newAlt } );\n\t}\n\n\tupdateAlignment( nextAlign ) {\n\t\tconst extraUpdatedAttributes = [ 'wide', 'full' ].indexOf( nextAlign ) !== -1 ?\n\t\t\t{ width: undefined, height: undefined } :\n\t\t\t{};\n\t\tthis.props.setAttributes( { ...extraUpdatedAttributes, align: nextAlign } );\n\t}\n\n\tupdateImageURL( url ) {\n\t\tthis.props.setAttributes( { url, width: undefined, height: undefined } );\n\t}\n\n\tupdateWidth( width ) {\n\t\tthis.props.setAttributes( { width: parseInt( width, 10 ) } );\n\t}\n\n\tupdateHeight( height ) {\n\t\tthis.props.setAttributes( { height: parseInt( height, 10 ) } );\n\t}\n\n\tupdateDimensions( width = undefined, height = undefined ) {\n\t\treturn () => {\n\t\t\tthis.props.setAttributes( { width, height } );\n\t\t};\n\t}\n\n\tgetImageSizes() {\n\t\treturn get( this.props.image, [ 'media_details', 'sizes' ], {} );\n\t}\n\n\tgetLinkDestinationOptions() {\n\t\treturn [\n\t\t\t{ value: LINK_DESTINATION_NONE, label: __( 'None' ) },\n\t\t\t{ value: LINK_DESTINATION_MEDIA, label: __( 'Media File' ) },\n\t\t\t{ value: LINK_DESTINATION_ATTACHMENT, label: __( 'Attachment Page' ) },\n\t\t\t{ value: LINK_DESTINATION_CUSTOM, label: __( 'Custom URL' ) },\n\t\t];\n\t}\n\n\ttoggleIsEditing() {\n\t\tthis.setState( {\n\t\t\tisEditing: ! this.state.isEditing,\n\t\t} );\n\t}\n\n\trender() {\n\t\tconst { isEditing } = this.state;\n\t\tconst {\n\t\t\tattributes,\n\t\t\tsetAttributes,\n\t\t\tisLargeViewport,\n\t\t\tisSelected,\n\t\t\tclassName,\n\t\t\tmaxWidth,\n\t\t\tnoticeOperations,\n\t\t\tnoticeUI,\n\t\t\ttoggleSelection,\n\t\t\tisRTL,\n\t\t\tavailableImageSizes,\n\t\t} = this.props;\n\t\tconst { url, alt, caption, align, id, href, linkDestination, width, height, linkTarget } = attributes;\n\t\tconst isExternal = isExternalImage( id, url );\n\t\tconst availableImageSizesBySlug = keyBy( availableImageSizes, 'slug' );\n\n\t\tlet toolbarEditButton;\n\t\tif ( url ) {\n\t\t\tif ( isExternal ) {\n\t\t\t\ttoolbarEditButton = (\n\t\t\t\t\t<Toolbar>\n\t\t\t\t\t\t<IconButton\n\t\t\t\t\t\t\tclassName=\"components-icon-button components-toolbar__control\"\n\t\t\t\t\t\t\tlabel={ __( 'Edit image' ) }\n\t\t\t\t\t\t\tonClick={ this.toggleIsEditing }\n\t\t\t\t\t\t\ticon=\"edit\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Toolbar>\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\ttoolbarEditButton = (\n\t\t\t\t\t<Toolbar>\n\t\t\t\t\t\t<MediaUpload\n\t\t\t\t\t\t\tonSelect={ this.onSelectImage }\n\t\t\t\t\t\t\tallowedTypes={ ALLOWED_MEDIA_TYPES }\n\t\t\t\t\t\t\tvalue={ id }\n\t\t\t\t\t\t\trender={ ( { open } ) => (\n\t\t\t\t\t\t\t\t<IconButton\n\t\t\t\t\t\t\t\t\tclassName=\"components-toolbar__control\"\n\t\t\t\t\t\t\t\t\tlabel={ __( 'Edit image' ) }\n\t\t\t\t\t\t\t\t\ticon=\"edit\"\n\t\t\t\t\t\t\t\t\tonClick={ open }\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Toolbar>\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tconst controls = (\n\t\t\t<BlockControls>\n\t\t\t\t<BlockAlignmentToolbar\n\t\t\t\t\tvalue={ align }\n\t\t\t\t\tonChange={ this.updateAlignment }\n\t\t\t\t/>\n\t\t\t\t{ toolbarEditButton }\n\t\t\t</BlockControls>\n\t\t);\n\n\t\tif ( isEditing ) {\n\t\t\tconst src = isExternal ? url : undefined;\n\t\t\treturn (\n\t\t\t\t<Fragment>\n\t\t\t\t\t{ controls }\n\t\t\t\t\t<MediaPlaceholder\n\t\t\t\t\t\ticon=\"format-image\"\n\t\t\t\t\t\tclassName={ className }\n\t\t\t\t\t\tonSelect={ this.onSelectImage }\n\t\t\t\t\t\tonSelectURL={ this.onSelectURL }\n\t\t\t\t\t\tnotices={ noticeUI }\n\t\t\t\t\t\tonError={ noticeOperations.createErrorNotice }\n\t\t\t\t\t\taccept=\"image/*\"\n\t\t\t\t\t\tallowedTypes={ ALLOWED_MEDIA_TYPES }\n\t\t\t\t\t\tvalue={ { id, src } }\n\t\t\t\t\t/>\n\t\t\t\t</Fragment>\n\t\t\t);\n\t\t}\n\n\t\tconst classes = classnames( className, {\n\t\t\t'is-transient': isBlobURL( url ),\n\t\t\t'is-resized': !! width || !! height,\n\t\t\t'is-focused': isSelected,\n\t\t} );\n\n\t\tconst imageSizes = this.getImageSizes();\n\t\tconst isResizable = [ 'wide', 'full' ].indexOf( align ) === -1 && isLargeViewport;\n\t\tconst isLinkURLInputDisabled = linkDestination !== LINK_DESTINATION_CUSTOM;\n\n\t\tconst getInspectorControls = ( imageWidth, imageHeight ) => (\n\t\t\t<InspectorControls>\n\t\t\t\t<PanelBody title={ __( 'Image Settings' ) }>\n\t\t\t\t\t<TextareaControl\n\t\t\t\t\t\tlabel={ __( 'Alt Text (Alternative Text)' ) }\n\t\t\t\t\t\tvalue={ alt }\n\t\t\t\t\t\tonChange={ this.updateAlt }\n\t\t\t\t\t\thelp={ __( 'Alternative text describes your image to people who can’t see it. Add a short description with its key details.' ) }\n\t\t\t\t\t/>\n\t\t\t\t\t{ ! isEmpty( imageSizes ) && (\n\t\t\t\t\t\t<SelectControl\n\t\t\t\t\t\t\tlabel={ __( 'Image Size' ) }\n\t\t\t\t\t\t\tvalue={ url }\n\t\t\t\t\t\t\toptions={ map( imageSizes, ( size, slug ) => ( {\n\t\t\t\t\t\t\t\tvalue: size.source_url,\n\t\t\t\t\t\t\t\tlabel: availableImageSizesBySlug[ slug ] ? availableImageSizesBySlug[ slug ].name : startCase( slug ),\n\t\t\t\t\t\t\t} ) ) }\n\t\t\t\t\t\t\tonChange={ this.updateImageURL }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t\t{ isResizable && (\n\t\t\t\t\t\t<div className=\"block-library-image__dimensions\">\n\t\t\t\t\t\t\t<p className=\"block-library-image__dimensions__row\">\n\t\t\t\t\t\t\t\t{ __( 'Image Dimensions' ) }\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t<div className=\"block-library-image__dimensions__row\">\n\t\t\t\t\t\t\t\t<TextControl\n\t\t\t\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t\t\t\tclassName=\"block-library-image__dimensions__width\"\n\t\t\t\t\t\t\t\t\tlabel={ __( 'Width' ) }\n\t\t\t\t\t\t\t\t\tvalue={ width !== undefined ? width : '' }\n\t\t\t\t\t\t\t\t\tplaceholder={ imageWidth }\n\t\t\t\t\t\t\t\t\tmin={ 1 }\n\t\t\t\t\t\t\t\t\tonChange={ this.updateWidth }\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<TextControl\n\t\t\t\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t\t\t\tclassName=\"block-library-image__dimensions__height\"\n\t\t\t\t\t\t\t\t\tlabel={ __( 'Height' ) }\n\t\t\t\t\t\t\t\t\tvalue={ height !== undefined ? height : '' }\n\t\t\t\t\t\t\t\t\tplaceholder={ imageHeight }\n\t\t\t\t\t\t\t\t\tmin={ 1 }\n\t\t\t\t\t\t\t\t\tonChange={ this.updateHeight }\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"block-library-image__dimensions__row\">\n\t\t\t\t\t\t\t\t<ButtonGroup aria-label={ __( 'Image Size' ) }>\n\t\t\t\t\t\t\t\t\t{ [ 25, 50, 75, 100 ].map( ( scale ) => {\n\t\t\t\t\t\t\t\t\t\tconst scaledWidth = Math.round( imageWidth * ( scale / 100 ) );\n\t\t\t\t\t\t\t\t\t\tconst scaledHeight = Math.round( imageHeight * ( scale / 100 ) );\n\n\t\t\t\t\t\t\t\t\t\tconst isCurrent = width === scaledWidth && height === scaledHeight;\n\n\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\t\tkey={ scale }\n\t\t\t\t\t\t\t\t\t\t\t\tisSmall\n\t\t\t\t\t\t\t\t\t\t\t\tisPrimary={ isCurrent }\n\t\t\t\t\t\t\t\t\t\t\t\taria-pressed={ isCurrent }\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={ this.updateDimensions( scaledWidth, scaledHeight ) }\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t{ scale }%\n\t\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t} ) }\n\t\t\t\t\t\t\t\t</ButtonGroup>\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\tisSmall\n\t\t\t\t\t\t\t\t\tonClick={ this.updateDimensions() }\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{ __( 'Reset' ) }\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t) }\n\t\t\t\t</PanelBody>\n\t\t\t\t<PanelBody title={ __( 'Link Settings' ) }>\n\t\t\t\t\t<SelectControl\n\t\t\t\t\t\tlabel={ __( 'Link To' ) }\n\t\t\t\t\t\tvalue={ linkDestination }\n\t\t\t\t\t\toptions={ this.getLinkDestinationOptions() }\n\t\t\t\t\t\tonChange={ this.onSetLinkDestination }\n\t\t\t\t\t/>\n\t\t\t\t\t{ linkDestination !== LINK_DESTINATION_NONE && (\n\t\t\t\t\t\t<Fragment>\n\t\t\t\t\t\t\t<TextControl\n\t\t\t\t\t\t\t\tlabel={ __( 'Link URL' ) }\n\t\t\t\t\t\t\t\tvalue={ href || '' }\n\t\t\t\t\t\t\t\tonChange={ this.onSetCustomHref }\n\t\t\t\t\t\t\t\tplaceholder={ ! isLinkURLInputDisabled ? 'https://' : undefined }\n\t\t\t\t\t\t\t\tdisabled={ isLinkURLInputDisabled }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<ToggleControl\n\t\t\t\t\t\t\t\tlabel={ __( 'Open in New Tab' ) }\n\t\t\t\t\t\t\t\tonChange={ () => setAttributes( { linkTarget: ! linkTarget ? '_blank' : undefined } ) }\n\t\t\t\t\t\t\t\tchecked={ linkTarget === '_blank' } />\n\t\t\t\t\t\t</Fragment>\n\t\t\t\t\t) }\n\t\t\t\t</PanelBody>\n\t\t\t</InspectorControls>\n\t\t);\n\n\t\t// Disable reason: Each block can be selected by clicking on it\n\t\t/* eslint-disable jsx-a11y/no-static-element-interactions, jsx-a11y/onclick-has-role, jsx-a11y/click-events-have-key-events */\n\t\treturn (\n\t\t\t<Fragment>\n\t\t\t\t{ controls }\n\t\t\t\t<figure className={ classes }>\n\t\t\t\t\t<ImageSize src={ url } dirtynessTrigger={ align }>\n\t\t\t\t\t\t{ ( sizes ) => {\n\t\t\t\t\t\t\tconst {\n\t\t\t\t\t\t\t\timageWidthWithinContainer,\n\t\t\t\t\t\t\t\timageHeightWithinContainer,\n\t\t\t\t\t\t\t\timageWidth,\n\t\t\t\t\t\t\t\timageHeight,\n\t\t\t\t\t\t\t} = sizes;\n\n\t\t\t\t\t\t\t// Disable reason: Image itself is not meant to be\n\t\t\t\t\t\t\t// interactive, but should direct focus to block\n\t\t\t\t\t\t\t// eslint-disable-next-line jsx-a11y/no-noninteractive-element-interactions\n\t\t\t\t\t\t\tconst img = <img src={ url } alt={ alt } onClick={ this.onImageClick } />;\n\n\t\t\t\t\t\t\tif ( ! isResizable || ! imageWidthWithinContainer ) {\n\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t<Fragment>\n\t\t\t\t\t\t\t\t\t\t{ getInspectorControls( imageWidth, imageHeight ) }\n\t\t\t\t\t\t\t\t\t\t<div style={ { width, height } }>\n\t\t\t\t\t\t\t\t\t\t\t{ img }\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</Fragment>\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst currentWidth = width || imageWidthWithinContainer;\n\t\t\t\t\t\t\tconst currentHeight = height || imageHeightWithinContainer;\n\n\t\t\t\t\t\t\tconst ratio = imageWidth / imageHeight;\n\t\t\t\t\t\t\tconst minWidth = imageWidth < imageHeight ? MIN_SIZE : MIN_SIZE * ratio;\n\t\t\t\t\t\t\tconst minHeight = imageHeight < imageWidth ? MIN_SIZE : MIN_SIZE / ratio;\n\n\t\t\t\t\t\t\tlet showRightHandle = false;\n\t\t\t\t\t\t\tlet showLeftHandle = false;\n\n\t\t\t\t\t\t\t/* eslint-disable no-lonely-if */\n\t\t\t\t\t\t\t// See https://github.com/WordPress/gutenberg/issues/7584.\n\t\t\t\t\t\t\tif ( align === 'center' ) {\n\t\t\t\t\t\t\t\t// When the image is centered, show both handles.\n\t\t\t\t\t\t\t\tshowRightHandle = true;\n\t\t\t\t\t\t\t\tshowLeftHandle = true;\n\t\t\t\t\t\t\t} else if ( isRTL ) {\n\t\t\t\t\t\t\t\t// In RTL mode the image is on the right by default.\n\t\t\t\t\t\t\t\t// Show the right handle and hide the left handle only when it is aligned left.\n\t\t\t\t\t\t\t\t// Otherwise always show the left handle.\n\t\t\t\t\t\t\t\tif ( align === 'left' ) {\n\t\t\t\t\t\t\t\t\tshowRightHandle = true;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tshowLeftHandle = true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// Show the left handle and hide the right handle only when the image is aligned right.\n\t\t\t\t\t\t\t\t// Otherwise always show the right handle.\n\t\t\t\t\t\t\t\tif ( align === 'right' ) {\n\t\t\t\t\t\t\t\t\tshowLeftHandle = true;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tshowRightHandle = true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t/* eslint-enable no-lonely-if */\n\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<Fragment>\n\t\t\t\t\t\t\t\t\t{ getInspectorControls( imageWidth, imageHeight ) }\n\t\t\t\t\t\t\t\t\t<ResizableBox\n\t\t\t\t\t\t\t\t\t\tsize={\n\t\t\t\t\t\t\t\t\t\t\twidth && height ? {\n\t\t\t\t\t\t\t\t\t\t\t\twidth,\n\t\t\t\t\t\t\t\t\t\t\t\theight,\n\t\t\t\t\t\t\t\t\t\t\t} : undefined\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tminWidth={ minWidth }\n\t\t\t\t\t\t\t\t\t\tmaxWidth={ maxWidth }\n\t\t\t\t\t\t\t\t\t\tminHeight={ minHeight }\n\t\t\t\t\t\t\t\t\t\tmaxHeight={ maxWidth / ratio }\n\t\t\t\t\t\t\t\t\t\tlockAspectRatio\n\t\t\t\t\t\t\t\t\t\tenable={ {\n\t\t\t\t\t\t\t\t\t\t\ttop: false,\n\t\t\t\t\t\t\t\t\t\t\tright: showRightHandle,\n\t\t\t\t\t\t\t\t\t\t\tbottom: true,\n\t\t\t\t\t\t\t\t\t\t\tleft: showLeftHandle,\n\t\t\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t\t\t\tonResizeStart={ () => {\n\t\t\t\t\t\t\t\t\t\t\ttoggleSelection( false );\n\t\t\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t\t\t\tonResizeStop={ ( event, direction, elt, delta ) => {\n\t\t\t\t\t\t\t\t\t\t\tsetAttributes( {\n\t\t\t\t\t\t\t\t\t\t\t\twidth: parseInt( currentWidth + delta.width, 10 ),\n\t\t\t\t\t\t\t\t\t\t\t\theight: parseInt( currentHeight + delta.height, 10 ),\n\t\t\t\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t\t\t\t\ttoggleSelection( true );\n\t\t\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{ img }\n\t\t\t\t\t\t\t\t\t</ResizableBox>\n\t\t\t\t\t\t\t\t</Fragment>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t} }\n\t\t\t\t\t</ImageSize>\n\t\t\t\t\t{ ( ! RichText.isEmpty( caption ) || isSelected ) && (\n\t\t\t\t\t\t<RichText\n\t\t\t\t\t\t\ttagName=\"figcaption\"\n\t\t\t\t\t\t\tplaceholder={ __( 'Write caption…' ) }\n\t\t\t\t\t\t\tvalue={ caption }\n\t\t\t\t\t\t\tunstableOnFocus={ this.onFocusCaption }\n\t\t\t\t\t\t\tonChange={ ( value ) => setAttributes( { caption: value } ) }\n\t\t\t\t\t\t\tisSelected={ this.state.captionFocused }\n\t\t\t\t\t\t\tinlineToolbar\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t</figure>\n\t\t\t</Fragment>\n\t\t);\n\t\t/* eslint-enable jsx-a11y/no-static-element-interactions, jsx-a11y/onclick-has-role, jsx-a11y/click-events-have-key-events */\n\t}\n}\n\nexport default compose( [\n\twithSelect( ( select, props ) => {\n\t\tconst { getMedia } = select( 'core' );\n\t\tconst { getEditorSettings } = select( 'core/editor' );\n\t\tconst { id } = props.attributes;\n\t\tconst { maxWidth, isRTL, availableImageSizes } = getEditorSettings();\n\n\t\treturn {\n\t\t\timage: id ? getMedia( id ) : null,\n\t\t\tmaxWidth,\n\t\t\tisRTL,\n\t\t\tavailableImageSizes,\n\t\t};\n\t} ),\n\twithViewportMatch( { isLargeViewport: 'medium' } ),\n\twithNotices,\n] )( ImageEdit );\n"]}