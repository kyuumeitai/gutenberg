{"version":3,"sources":["/Users/ky/Sites/valet/copesacontent/web/app/plugins/gutenberg/packages/editor/src/components/inserter/menu.js"],"names":["MAX_SUGGESTED_ITEMS","stopKeyPropagation","event","stopPropagation","searchItems","items","searchTerm","normalizedSearchTerm","normalizeTerm","matchSearch","string","indexOf","categories","filter","item","itemCategory","slug","category","title","keywords","term","replace","toLowerCase","trim","InserterMenu","arguments","state","childItems","filterValue","hoveredItem","suggestedItems","reusableItems","itemsPerCategory","openPanels","onChangeSearchInput","bind","onHover","panels","inserterResults","props","fetchReusableBlocks","prevProps","target","value","setState","showInsertionPoint","hideInsertionPoint","rootClientId","index","name","ref","panel","isOpened","setTimeout","current","alignWithTop","debouncedSpeak","rootChildBlocks","filteredItems","maxSuggestedItems","utility","slice","getCategoryIndex","itemList","length","firstCategory","resultCount","Object","keys","reduce","accumulator","currentCategorySlug","resultsFoundMessage","LEFT","DOWN","RIGHT","UP","BACKSPACE","ENTER","keyCode","instanceId","onSelect","isPanelOpen","isSearching","onKeyDown","onTogglePanel","bindPanel","categoryItems","icon","initialAttributes","Component","select","getEditedPostAttribute","getSelectedBlock","getInserterItems","getBlockName","getChildBlockNames","rootBlockName","selectedBlock","dispatch","ownProps","__experimentalFetchReusableBlocks","replaceBlocks","insertBlock","insertedBlock","clientId","withSpokenMessages","withInstanceId","withSafeTimeout"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport {\n\tfilter,\n\tfind,\n\tfindIndex,\n\tflow,\n\tgroupBy,\n\tisEmpty,\n\tmap,\n\tsome,\n\tsortBy,\n\twithout,\n\tincludes,\n\tdeburr,\n} from 'lodash';\nimport scrollIntoView from 'dom-scroll-into-view';\n\n/**\n * WordPress dependencies\n */\nimport { __, _n, _x, sprintf } from '@wordpress/i18n';\nimport { Component, createRef } from '@wordpress/element';\nimport { withSpokenMessages, PanelBody } from '@wordpress/components';\nimport {\n\tgetCategories,\n\tisReusableBlock,\n\tcreateBlock,\n\tisUnmodifiedDefaultBlock,\n} from '@wordpress/blocks';\nimport { withDispatch, withSelect } from '@wordpress/data';\nimport { withInstanceId, compose, withSafeTimeout } from '@wordpress/compose';\nimport { LEFT, RIGHT, UP, DOWN, BACKSPACE, ENTER } from '@wordpress/keycodes';\n\n/**\n * Internal dependencies\n */\nimport BlockPreview from '../block-preview';\nimport BlockTypesList from '../block-types-list';\nimport ChildBlocks from './child-blocks';\nimport InserterInlineElements from './inline-elements';\n\nconst MAX_SUGGESTED_ITEMS = 9;\n\nconst stopKeyPropagation = ( event ) => event.stopPropagation();\n\n/**\n * Filters an item list given a search term.\n *\n * @param {Array} items        Item list\n * @param {string} searchTerm  Search term.\n *\n * @return {Array}             Filtered item list.\n */\nexport const searchItems = ( items, searchTerm ) => {\n\tconst normalizedSearchTerm = normalizeTerm( searchTerm );\n\tconst matchSearch = ( string ) => normalizeTerm( string ).indexOf( normalizedSearchTerm ) !== -1;\n\tconst categories = getCategories();\n\n\treturn items.filter( ( item ) => {\n\t\tconst itemCategory = find( categories, { slug: item.category } );\n\t\treturn matchSearch( item.title ) || some( item.keywords, matchSearch ) || ( itemCategory && matchSearch( itemCategory.title ) );\n\t} );\n};\n\n/**\n * Converts the search term into a normalized term.\n *\n * @param {string} term The search term to normalize.\n *\n * @return {string} The normalized search term.\n */\nexport const normalizeTerm = ( term ) => {\n\t// Disregard diacritics.\n\t//  Input: \"mÃ©dia\"\n\tterm = deburr( term );\n\n\t// Accommodate leading slash, matching autocomplete expectations.\n\t//  Input: \"/media\"\n\tterm = term.replace( /^\\//, '' );\n\n\t// Lowercase.\n\t//  Input: \"MEDIA\"\n\tterm = term.toLowerCase();\n\n\t// Strip leading and trailing whitespace.\n\t//  Input: \" media \"\n\tterm = term.trim();\n\n\treturn term;\n};\n\nexport class InserterMenu extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\t\tthis.state = {\n\t\t\tchildItems: [],\n\t\t\tfilterValue: '',\n\t\t\thoveredItem: null,\n\t\t\tsuggestedItems: [],\n\t\t\treusableItems: [],\n\t\t\titemsPerCategory: {},\n\t\t\topenPanels: [ 'suggested' ],\n\t\t};\n\t\tthis.onChangeSearchInput = this.onChangeSearchInput.bind( this );\n\t\tthis.onHover = this.onHover.bind( this );\n\t\tthis.panels = {};\n\t\tthis.inserterResults = createRef();\n\t}\n\n\tcomponentDidMount() {\n\t\t// This could be replaced by a resolver.\n\t\tthis.props.fetchReusableBlocks();\n\t\tthis.filter();\n\t}\n\n\tcomponentDidUpdate( prevProps ) {\n\t\tif ( prevProps.items !== this.props.items ) {\n\t\t\tthis.filter( this.state.filterValue );\n\t\t}\n\t}\n\n\tonChangeSearchInput( event ) {\n\t\tthis.filter( event.target.value );\n\t}\n\n\tonHover( item ) {\n\t\tthis.setState( {\n\t\t\thoveredItem: item,\n\t\t} );\n\n\t\tconst { showInsertionPoint, hideInsertionPoint } = this.props;\n\t\tif ( item ) {\n\t\t\tconst { rootClientId, index } = this.props;\n\t\t\tshowInsertionPoint( rootClientId, index );\n\t\t} else {\n\t\t\thideInsertionPoint();\n\t\t}\n\t}\n\n\tbindPanel( name ) {\n\t\treturn ( ref ) => {\n\t\t\tthis.panels[ name ] = ref;\n\t\t};\n\t}\n\n\tonTogglePanel( panel ) {\n\t\treturn () => {\n\t\t\tconst isOpened = this.state.openPanels.indexOf( panel ) !== -1;\n\t\t\tif ( isOpened ) {\n\t\t\t\tthis.setState( {\n\t\t\t\t\topenPanels: without( this.state.openPanels, panel ),\n\t\t\t\t} );\n\t\t\t} else {\n\t\t\t\tthis.setState( {\n\t\t\t\t\topenPanels: [\n\t\t\t\t\t\t...this.state.openPanels,\n\t\t\t\t\t\tpanel,\n\t\t\t\t\t],\n\t\t\t\t} );\n\n\t\t\t\tthis.props.setTimeout( () => {\n\t\t\t\t\t// We need a generic way to access the panel's container\n\t\t\t\t\t// eslint-disable-next-line react/no-find-dom-node\n\t\t\t\t\tscrollIntoView( this.panels[ panel ], this.inserterResults.current, {\n\t\t\t\t\t\talignWithTop: true,\n\t\t\t\t\t} );\n\t\t\t\t} );\n\t\t\t}\n\t\t};\n\t}\n\n\tfilter( filterValue = '' ) {\n\t\tconst { debouncedSpeak, items, rootChildBlocks } = this.props;\n\t\tconst filteredItems = searchItems( items, filterValue );\n\n\t\tconst childItems = filter( filteredItems, ( { name } ) => includes( rootChildBlocks, name ) );\n\n\t\tlet suggestedItems = [];\n\t\tif ( ! filterValue ) {\n\t\t\tconst maxSuggestedItems = this.props.maxSuggestedItems || MAX_SUGGESTED_ITEMS;\n\t\t\tsuggestedItems = filter( items, ( item ) => item.utility > 0 ).slice( 0, maxSuggestedItems );\n\t\t}\n\n\t\tconst reusableItems = filter( filteredItems, { category: 'reusable' } );\n\n\t\tconst getCategoryIndex = ( item ) => {\n\t\t\treturn findIndex( getCategories(), ( category ) => category.slug === item.category );\n\t\t};\n\t\tconst itemsPerCategory = flow(\n\t\t\t( itemList ) => filter( itemList, ( item ) => item.category !== 'reusable' ),\n\t\t\t( itemList ) => sortBy( itemList, getCategoryIndex ),\n\t\t\t( itemList ) => groupBy( itemList, 'category' )\n\t\t)( filteredItems );\n\n\t\tlet openPanels = this.state.openPanels;\n\t\tif ( filterValue !== this.state.filterValue ) {\n\t\t\tif ( ! filterValue ) {\n\t\t\t\topenPanels = [ 'suggested' ];\n\t\t\t} else if ( reusableItems.length ) {\n\t\t\t\topenPanels = [ 'reusable' ];\n\t\t\t} else if ( filteredItems.length ) {\n\t\t\t\tconst firstCategory = find( getCategories(), ( { slug } ) => itemsPerCategory[ slug ] && itemsPerCategory[ slug ].length );\n\t\t\t\topenPanels = [ firstCategory.slug ];\n\t\t\t}\n\t\t}\n\n\t\tthis.setState( {\n\t\t\thoveredItem: null,\n\t\t\tchildItems,\n\t\t\tfilterValue,\n\t\t\tsuggestedItems,\n\t\t\treusableItems,\n\t\t\titemsPerCategory,\n\t\t\topenPanels,\n\t\t} );\n\n\t\tconst resultCount = Object.keys( itemsPerCategory ).reduce( ( accumulator, currentCategorySlug ) => {\n\t\t\treturn accumulator + itemsPerCategory[ currentCategorySlug ].length;\n\t\t}, 0 );\n\n\t\tconst resultsFoundMessage = sprintf(\n\t\t\t_n( '%d result found.', '%d results found.', resultCount ),\n\t\t\tresultCount\n\t\t);\n\n\t\tdebouncedSpeak( resultsFoundMessage, 'assertive' );\n\t}\n\n\tonKeyDown( event ) {\n\t\tif ( includes( [ LEFT, DOWN, RIGHT, UP, BACKSPACE, ENTER ], event.keyCode ) ) {\n\t\t\t// Stop the key event from propagating up to ObserveTyping.startTypingInTextField.\n\t\t\tevent.stopPropagation();\n\t\t}\n\t}\n\n\trender() {\n\t\tconst { instanceId, onSelect, rootClientId } = this.props;\n\t\tconst { childItems, filterValue, hoveredItem, suggestedItems, reusableItems, itemsPerCategory, openPanels } = this.state;\n\t\tconst isPanelOpen = ( panel ) => openPanels.indexOf( panel ) !== -1;\n\t\tconst isSearching = !! filterValue;\n\n\t\t// Disable reason (no-autofocus): The inserter menu is a modal display, not one which\n\t\t// is always visible, and one which already incurs this behavior of autoFocus via\n\t\t// Popover's focusOnMount.\n\t\t// Disable reason (no-static-element-interactions): Navigational key-presses within\n\t\t// the menu are prevented from triggering WritingFlow and ObserveTyping interactions.\n\t\t/* eslint-disable jsx-a11y/no-autofocus, jsx-a11y/no-static-element-interactions */\n\t\treturn (\n\t\t\t<div\n\t\t\t\tclassName=\"editor-inserter__menu\"\n\t\t\t\tonKeyPress={ stopKeyPropagation }\n\t\t\t\tonKeyDown={ this.onKeyDown }\n\t\t\t>\n\t\t\t\t<label htmlFor={ `editor-inserter__search-${ instanceId }` } className=\"screen-reader-text\">\n\t\t\t\t\t{ __( 'Search for a block' ) }\n\t\t\t\t</label>\n\t\t\t\t<input\n\t\t\t\t\tid={ `editor-inserter__search-${ instanceId }` }\n\t\t\t\t\ttype=\"search\"\n\t\t\t\t\tplaceholder={ __( 'Search for a block' ) }\n\t\t\t\t\tclassName=\"editor-inserter__search\"\n\t\t\t\t\tautoFocus\n\t\t\t\t\tonChange={ this.onChangeSearchInput }\n\t\t\t\t/>\n\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"editor-inserter__results\"\n\t\t\t\t\tref={ this.inserterResults }\n\t\t\t\t\ttabIndex=\"0\"\n\t\t\t\t\trole=\"region\"\n\t\t\t\t\taria-label={ __( 'Available block types' ) }\n\t\t\t\t>\n\n\t\t\t\t\t<ChildBlocks\n\t\t\t\t\t\trootClientId={ rootClientId }\n\t\t\t\t\t\titems={ childItems }\n\t\t\t\t\t\tonSelect={ onSelect }\n\t\t\t\t\t\tonHover={ this.onHover }\n\t\t\t\t\t/>\n\n\t\t\t\t\t{ !! suggestedItems.length &&\n\t\t\t\t\t\t<PanelBody\n\t\t\t\t\t\t\ttitle={ _x( 'Most Used', 'blocks' ) }\n\t\t\t\t\t\t\topened={ isPanelOpen( 'suggested' ) }\n\t\t\t\t\t\t\tonToggle={ this.onTogglePanel( 'suggested' ) }\n\t\t\t\t\t\t\tref={ this.bindPanel( 'suggested' ) }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<BlockTypesList items={ suggestedItems } onSelect={ onSelect } onHover={ this.onHover } />\n\t\t\t\t\t\t</PanelBody>\n\t\t\t\t\t}\n\n\t\t\t\t\t<InserterInlineElements filterValue={ filterValue } />\n\n\t\t\t\t\t{ map( getCategories(), ( category ) => {\n\t\t\t\t\t\tconst categoryItems = itemsPerCategory[ category.slug ];\n\t\t\t\t\t\tif ( ! categoryItems || ! categoryItems.length ) {\n\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<PanelBody\n\t\t\t\t\t\t\t\tkey={ category.slug }\n\t\t\t\t\t\t\t\ttitle={ category.title }\n\t\t\t\t\t\t\t\ticon={ category.icon }\n\t\t\t\t\t\t\t\topened={ isSearching || isPanelOpen( category.slug ) }\n\t\t\t\t\t\t\t\tonToggle={ this.onTogglePanel( category.slug ) }\n\t\t\t\t\t\t\t\tref={ this.bindPanel( category.slug ) }\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<BlockTypesList items={ categoryItems } onSelect={ onSelect } onHover={ this.onHover } />\n\t\t\t\t\t\t\t</PanelBody>\n\t\t\t\t\t\t);\n\t\t\t\t\t} ) }\n\n\t\t\t\t\t{ !! reusableItems.length && (\n\t\t\t\t\t\t<PanelBody\n\t\t\t\t\t\t\tclassName=\"editor-inserter__reusable-blocks-panel\"\n\t\t\t\t\t\t\ttitle={ __( 'Reusable' ) }\n\t\t\t\t\t\t\topened={ isPanelOpen( 'reusable' ) }\n\t\t\t\t\t\t\tonToggle={ this.onTogglePanel( 'reusable' ) }\n\t\t\t\t\t\t\ticon=\"controls-repeat\"\n\t\t\t\t\t\t\tref={ this.bindPanel( 'reusable' ) }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<BlockTypesList items={ reusableItems } onSelect={ onSelect } onHover={ this.onHover } />\n\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\tclassName=\"editor-inserter__manage-reusable-blocks\"\n\t\t\t\t\t\t\t\thref=\"edit.php?post_type=wp_block\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{ __( 'Manage All Reusable Blocks' ) }\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</PanelBody>\n\t\t\t\t\t) }\n\t\t\t\t\t{ isEmpty( suggestedItems ) && isEmpty( reusableItems ) && isEmpty( itemsPerCategory ) && (\n\t\t\t\t\t\t<p className=\"editor-inserter__no-results\">{ __( 'No blocks found.' ) }</p>\n\t\t\t\t\t) }\n\t\t\t\t</div>\n\n\t\t\t\t{ hoveredItem && isReusableBlock( hoveredItem ) &&\n\t\t\t\t\t<BlockPreview name={ hoveredItem.name } attributes={ hoveredItem.initialAttributes } />\n\t\t\t\t}\n\t\t\t</div>\n\t\t);\n\t\t/* eslint-enable jsx-a11y/no-autofocus, jsx-a11y/no-noninteractive-element-interactions */\n\t}\n}\n\nexport default compose(\n\twithSelect( ( select, { rootClientId } ) => {\n\t\tconst {\n\t\t\tgetEditedPostAttribute,\n\t\t\tgetSelectedBlock,\n\t\t\tgetInserterItems,\n\t\t\tgetBlockName,\n\t\t} = select( 'core/editor' );\n\t\tconst {\n\t\t\tgetChildBlockNames,\n\t\t} = select( 'core/blocks' );\n\n\t\tconst rootBlockName = getBlockName( rootClientId );\n\n\t\treturn {\n\t\t\tselectedBlock: getSelectedBlock(),\n\t\t\trootChildBlocks: getChildBlockNames( rootBlockName ),\n\t\t\ttitle: getEditedPostAttribute( 'title' ),\n\t\t\titems: getInserterItems( rootClientId ),\n\t\t\trootClientId,\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch, ownProps ) => {\n\t\tconst {\n\t\t\t__experimentalFetchReusableBlocks: fetchReusableBlocks,\n\t\t\tshowInsertionPoint,\n\t\t\thideInsertionPoint,\n\t\t} = dispatch( 'core/editor' );\n\n\t\treturn {\n\t\t\tfetchReusableBlocks,\n\t\t\tshowInsertionPoint,\n\t\t\thideInsertionPoint,\n\t\t\tonSelect( item ) {\n\t\t\t\tconst {\n\t\t\t\t\treplaceBlocks,\n\t\t\t\t\tinsertBlock,\n\t\t\t\t} = dispatch( 'core/editor' );\n\t\t\t\tconst { selectedBlock, index, rootClientId } = ownProps;\n\t\t\t\tconst { name, initialAttributes } = item;\n\n\t\t\t\tconst insertedBlock = createBlock( name, initialAttributes );\n\t\t\t\tif ( selectedBlock && isUnmodifiedDefaultBlock( selectedBlock ) ) {\n\t\t\t\t\treplaceBlocks( selectedBlock.clientId, insertedBlock );\n\t\t\t\t} else {\n\t\t\t\t\tinsertBlock( insertedBlock, index, rootClientId );\n\t\t\t\t}\n\n\t\t\t\townProps.onSelect();\n\t\t\t},\n\t\t};\n\t} ),\n\twithSpokenMessages,\n\twithInstanceId,\n\twithSafeTimeout\n)( InserterMenu );\n"]}