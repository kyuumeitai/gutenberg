{"version":3,"sources":["/Users/ky/Sites/valet/copesacontent/web/app/plugins/gutenberg/packages/editor/src/components/autosave-monitor/index.js"],"names":["Component","compose","withSelect","withDispatch","AutosaveMonitor","prevProps","props","isDirty","editsReference","isAutosaveable","toggleTimer","isPendingSave","clearTimeout","pendingSave","autosaveInterval","setTimeout","autosave","select","isEditedPostDirty","isEditedPostAutosaveable","getEditorSettings","getReferenceByDistinctEdits","dispatch"],"mappings":";;;;;;AAAA;;;AAGA,SAASA,SAAT,QAA0B,oBAA1B;AACA,SAASC,OAAT,QAAwB,oBAAxB;AACA,SAASC,UAAT,EAAqBC,YAArB,QAAyC,iBAAzC;AAEA,WAAaC,eAAb;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA,uCACqBC,SADrB,EACiC;AAAA,wBACqB,KAAKC,KAD1B;AAAA,UACvBC,OADuB,eACvBA,OADuB;AAAA,UACdC,cADc,eACdA,cADc;AAAA,UACEC,cADF,eACEA,cADF;;AAG/B,UACCJ,SAAS,CAACE,OAAV,KAAsBA,OAAtB,IACAF,SAAS,CAACI,cAAV,KAA6BA,cAD7B,IAEAJ,SAAS,CAACG,cAAV,KAA6BA,cAH9B,EAIE;AACD,aAAKE,WAAL,CAAkBH,OAAO,IAAIE,cAA7B;AACA;AACD;AAXF;AAAA;AAAA,2CAawB;AACtB,WAAKC,WAAL,CAAkB,KAAlB;AACA;AAfF;AAAA;AAAA,gCAiBcC,aAjBd,EAiB8B;AAAA;;AAC5BC,MAAAA,YAAY,CAAE,KAAKC,WAAP,CAAZ;AAD4B,UAEpBC,gBAFoB,GAEC,KAAKR,KAFN,CAEpBQ,gBAFoB;;AAG5B,UAAKH,aAAL,EAAqB;AACpB,aAAKE,WAAL,GAAmBE,UAAU,CAC5B;AAAA,iBAAM,KAAI,CAACT,KAAL,CAAWU,QAAX,EAAN;AAAA,SAD4B,EAE5BF,gBAAgB,GAAG,IAFS,CAA7B;AAIA;AACD;AA1BF;AAAA;AAAA,6BA4BU;AACR,aAAO,IAAP;AACA;AA9BF;;AAAA;AAAA,EAAqCd,SAArC;AAiCA,eAAeC,OAAO,CAAE,CACvBC,UAAU,CAAE,UAAEe,MAAF,EAAc;AAAA,gBAMrBA,MAAM,CAAE,aAAF,CANe;AAAA,MAExBC,iBAFwB,WAExBA,iBAFwB;AAAA,MAGxBC,wBAHwB,WAGxBA,wBAHwB;AAAA,MAIxBC,iBAJwB,WAIxBA,iBAJwB;AAAA,MAKxBC,2BALwB,WAKxBA,2BALwB;;AAAA,2BAQID,iBAAiB,EARrB;AAAA,MAQjBN,gBARiB,sBAQjBA,gBARiB;;AAUzB,SAAO;AACNP,IAAAA,OAAO,EAAEW,iBAAiB,EADpB;AAENT,IAAAA,cAAc,EAAEU,wBAAwB,EAFlC;AAGNX,IAAAA,cAAc,EAAEa,2BAA2B,EAHrC;AAINP,IAAAA,gBAAgB,EAAhBA;AAJM,GAAP;AAMA,CAhBS,CADa,EAkBvBX,YAAY,CAAE,UAAEmB,QAAF;AAAA,SAAkB;AAC/BN,IAAAA,QAAQ,EAAEM,QAAQ,CAAE,aAAF,CAAR,CAA0BN;AADL,GAAlB;AAAA,CAAF,CAlBW,CAAF,CAAP,CAqBVZ,eArBU,CAAf","sourcesContent":["/**\n * WordPress dependencies\n */\nimport { Component } from '@wordpress/element';\nimport { compose } from '@wordpress/compose';\nimport { withSelect, withDispatch } from '@wordpress/data';\n\nexport class AutosaveMonitor extends Component {\n\tcomponentDidUpdate( prevProps ) {\n\t\tconst { isDirty, editsReference, isAutosaveable } = this.props;\n\n\t\tif (\n\t\t\tprevProps.isDirty !== isDirty ||\n\t\t\tprevProps.isAutosaveable !== isAutosaveable ||\n\t\t\tprevProps.editsReference !== editsReference\n\t\t) {\n\t\t\tthis.toggleTimer( isDirty && isAutosaveable );\n\t\t}\n\t}\n\n\tcomponentWillUnmount() {\n\t\tthis.toggleTimer( false );\n\t}\n\n\ttoggleTimer( isPendingSave ) {\n\t\tclearTimeout( this.pendingSave );\n\t\tconst { autosaveInterval } = this.props;\n\t\tif ( isPendingSave ) {\n\t\t\tthis.pendingSave = setTimeout(\n\t\t\t\t() => this.props.autosave(),\n\t\t\t\tautosaveInterval * 1000\n\t\t\t);\n\t\t}\n\t}\n\n\trender() {\n\t\treturn null;\n\t}\n}\n\nexport default compose( [\n\twithSelect( ( select ) => {\n\t\tconst {\n\t\t\tisEditedPostDirty,\n\t\t\tisEditedPostAutosaveable,\n\t\t\tgetEditorSettings,\n\t\t\tgetReferenceByDistinctEdits,\n\t\t} = select( 'core/editor' );\n\n\t\tconst { autosaveInterval } = getEditorSettings();\n\n\t\treturn {\n\t\t\tisDirty: isEditedPostDirty(),\n\t\t\tisAutosaveable: isEditedPostAutosaveable(),\n\t\t\teditsReference: getReferenceByDistinctEdits(),\n\t\t\tautosaveInterval,\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch ) => ( {\n\t\tautosave: dispatch( 'core/editor' ).autosave,\n\t} ) ),\n] )( AutosaveMonitor );\n"]}