{"version":3,"sources":["/Users/ky/Sites/valet/copesacontent/web/app/plugins/gutenberg/packages/editor/src/components/media-placeholder/index.js"],"names":["InsertFromURLPopover","src","onChange","onSubmit","onClose","MediaPlaceholder","arguments","state","isURLInputVisible","onChangeSrc","bind","onSubmitSrc","onUpload","onFilesUpload","openURLInput","closeURLInput","allowedTypes","props","allowedType","setState","value","prevProps","event","target","preventDefault","onSelectURL","files","onSelect","multiple","onError","setMedia","media","filesList","onFileChange","accept","icon","className","labels","onHTMLDrop","noop","notices","instructions","title","isOneType","length","isAudio","isImage","isVideo","onlyAllowsImages","id","open","Component"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { every, get, noop, startsWith } from 'lodash';\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport {\n\tButton,\n\tFormFileUpload,\n\tPlaceholder,\n\tDropZone,\n\tIconButton,\n\twithFilters,\n} from '@wordpress/components';\nimport { __ } from '@wordpress/i18n';\nimport { Component } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport MediaUpload from '../media-upload';\nimport URLPopover from '../url-popover';\nimport { mediaUpload } from '../../utils/';\n\nconst InsertFromURLPopover = ( { src, onChange, onSubmit, onClose } ) => (\n\t<URLPopover onClose={ onClose }>\n\t\t<form\n\t\t\tclassName=\"editor-media-placeholder__url-input-form\"\n\t\t\tonSubmit={ onSubmit }\n\t\t>\n\t\t\t<input\n\t\t\t\tclassName=\"editor-media-placeholder__url-input-field\"\n\t\t\t\ttype=\"url\"\n\t\t\t\taria-label={ __( 'URL' ) }\n\t\t\t\tplaceholder={ __( 'Paste or type URL' ) }\n\t\t\t\tonChange={ onChange }\n\t\t\t\tvalue={ src }\n\t\t\t/>\n\t\t\t<IconButton\n\t\t\t\tclassName=\"editor-media-placeholder__url-input-submit-button\"\n\t\t\t\ticon=\"editor-break\"\n\t\t\t\tlabel={ __( 'Apply' ) }\n\t\t\t\ttype=\"submit\"\n\t\t\t/>\n\t\t</form>\n\t</URLPopover>\n);\n\nclass MediaPlaceholder extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\t\tthis.state = {\n\t\t\tsrc: '',\n\t\t\tisURLInputVisible: false,\n\t\t};\n\t\tthis.onChangeSrc = this.onChangeSrc.bind( this );\n\t\tthis.onSubmitSrc = this.onSubmitSrc.bind( this );\n\t\tthis.onUpload = this.onUpload.bind( this );\n\t\tthis.onFilesUpload = this.onFilesUpload.bind( this );\n\t\tthis.openURLInput = this.openURLInput.bind( this );\n\t\tthis.closeURLInput = this.closeURLInput.bind( this );\n\t}\n\n\tonlyAllowsImages() {\n\t\tconst { allowedTypes } = this.props;\n\t\tif ( ! allowedTypes ) {\n\t\t\treturn false;\n\t\t}\n\t\treturn every( allowedTypes, ( allowedType ) => {\n\t\t\treturn allowedType === 'image' || startsWith( allowedType, 'image/' );\n\t\t} );\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.setState( { src: get( this.props.value, [ 'src' ], '' ) } );\n\t}\n\n\tcomponentDidUpdate( prevProps ) {\n\t\tif ( get( prevProps.value, [ 'src' ], '' ) !== get( this.props.value, [ 'src' ], '' ) ) {\n\t\t\tthis.setState( { src: get( this.props.value, [ 'src' ], '' ) } );\n\t\t}\n\t}\n\n\tonChangeSrc( event ) {\n\t\tthis.setState( { src: event.target.value } );\n\t}\n\n\tonSubmitSrc( event ) {\n\t\tevent.preventDefault();\n\t\tif ( this.state.src && this.props.onSelectURL ) {\n\t\t\tthis.props.onSelectURL( this.state.src );\n\t\t\tthis.closeURLInput();\n\t\t}\n\t}\n\n\tonUpload( event ) {\n\t\tthis.onFilesUpload( event.target.files );\n\t}\n\n\tonFilesUpload( files ) {\n\t\tconst { onSelect, multiple, onError, allowedTypes } = this.props;\n\t\tconst setMedia = multiple ? onSelect : ( [ media ] ) => onSelect( media );\n\t\tmediaUpload( {\n\t\t\tallowedTypes,\n\t\t\tfilesList: files,\n\t\t\tonFileChange: setMedia,\n\t\t\tonError,\n\t\t} );\n\t}\n\n\topenURLInput() {\n\t\tthis.setState( { isURLInputVisible: true } );\n\t}\n\n\tcloseURLInput() {\n\t\tthis.setState( { isURLInputVisible: false } );\n\t}\n\n\trender() {\n\t\tconst {\n\t\t\taccept,\n\t\t\ticon,\n\t\t\tclassName,\n\t\t\tlabels = {},\n\t\t\tonSelect,\n\t\t\tvalue = {},\n\t\t\tonSelectURL,\n\t\t\tonHTMLDrop = noop,\n\t\t\tmultiple = false,\n\t\t\tnotices,\n\t\t\tallowedTypes,\n\t\t} = this.props;\n\n\t\tconst {\n\t\t\tisURLInputVisible,\n\t\t\tsrc,\n\t\t} = this.state;\n\n\t\tlet instructions = labels.instructions || '';\n\t\tlet title = labels.title || '';\n\t\tif ( ! instructions || ! title ) {\n\t\t\tconst isOneType = 1 === allowedTypes.length;\n\t\t\tconst isAudio = isOneType && 'audio' === allowedTypes[ 0 ];\n\t\t\tconst isImage = isOneType && 'image' === allowedTypes[ 0 ];\n\t\t\tconst isVideo = isOneType && 'video' === allowedTypes[ 0 ];\n\n\t\t\tif ( ! instructions ) {\n\t\t\t\tinstructions = __( 'Drag a media file, upload a new one or select a file from your library.' );\n\n\t\t\t\tif ( isAudio ) {\n\t\t\t\t\tinstructions = __( 'Drag an audio, upload a new one or select a file from your library.' );\n\t\t\t\t} else if ( isImage ) {\n\t\t\t\t\tinstructions = __( 'Drag an image, upload a new one or select a file from your library.' );\n\t\t\t\t} else if ( isVideo ) {\n\t\t\t\t\tinstructions = __( 'Drag a video, upload a new one or select a file from your library.' );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( ! title ) {\n\t\t\t\ttitle = __( 'Media' );\n\n\t\t\t\tif ( isAudio ) {\n\t\t\t\t\ttitle = __( 'Audio' );\n\t\t\t\t} else if ( isImage ) {\n\t\t\t\t\ttitle = __( 'Image' );\n\t\t\t\t} else if ( isVideo ) {\n\t\t\t\t\ttitle = __( 'Video' );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn (\n\t\t\t<Placeholder\n\t\t\t\ticon={ icon }\n\t\t\t\tlabel={ title }\n\t\t\t\tinstructions={ instructions }\n\t\t\t\tclassName={ classnames( 'editor-media-placeholder', className ) }\n\t\t\t\tnotices={ notices }\n\t\t\t>\n\t\t\t\t<DropZone\n\t\t\t\t\tonFilesDrop={ this.onFilesUpload }\n\t\t\t\t\tonHTMLDrop={ onHTMLDrop }\n\t\t\t\t/>\n\t\t\t\t<FormFileUpload\n\t\t\t\t\tisLarge\n\t\t\t\t\tclassName=\"editor-media-placeholder__button\"\n\t\t\t\t\tonChange={ this.onUpload }\n\t\t\t\t\taccept={ accept }\n\t\t\t\t\tmultiple={ multiple }\n\t\t\t\t>\n\t\t\t\t\t{ __( 'Upload' ) }\n\t\t\t\t</FormFileUpload>\n\t\t\t\t<MediaUpload\n\t\t\t\t\tgallery={ multiple && this.onlyAllowsImages() }\n\t\t\t\t\tmultiple={ multiple }\n\t\t\t\t\tonSelect={ onSelect }\n\t\t\t\t\tallowedTypes={ allowedTypes }\n\t\t\t\t\tvalue={ value.id }\n\t\t\t\t\trender={ ( { open } ) => (\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tisLarge\n\t\t\t\t\t\t\tclassName=\"editor-media-placeholder__button\"\n\t\t\t\t\t\t\tonClick={ open }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ __( 'Media Library' ) }\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t) }\n\t\t\t\t/>\n\t\t\t\t{ onSelectURL && (\n\t\t\t\t\t<div className=\"editor-media-placeholder__url-input-container\">\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tclassName=\"editor-media-placeholder__button\"\n\t\t\t\t\t\t\tonClick={ this.openURLInput }\n\t\t\t\t\t\t\tisToggled={ isURLInputVisible }\n\t\t\t\t\t\t\tisLarge\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ __( 'Insert from URL' ) }\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t{ isURLInputVisible && (\n\t\t\t\t\t\t\t<InsertFromURLPopover\n\t\t\t\t\t\t\t\tsrc={ src }\n\t\t\t\t\t\t\t\tonChange={ this.onChangeSrc }\n\t\t\t\t\t\t\t\tonSubmit={ this.onSubmitSrc }\n\t\t\t\t\t\t\t\tonClose={ this.closeURLInput }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t) }\n\t\t\t\t\t</div>\n\t\t\t\t) }\n\t\t\t</Placeholder>\n\t\t);\n\t}\n}\n\nexport default withFilters( 'editor.MediaPlaceholder' )( MediaPlaceholder );\n"]}